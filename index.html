<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6th Grade Math</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the gamified platform */
        body {
            font-family: cursive, sans-serif; /* Fun, rounded system font */
            background: linear-gradient(to bottom, #6dd5ed, #2193b0); /* Sky blue gradient */
            color: #333;
            overflow: hidden; /* Hide scrollbars to keep the scene clean */
            margin: 0;
            padding: 0;
        }
        
        /* Language-specific fonts */
        .lang-en { font-family: cursive, sans-serif; }
        .lang-or { font-family: sans-serif; font-weight: 700; }
        .lang-or-body { font-family: sans-serif; font-weight: 400; }
        .lang-hi { font-family: sans-serif; font-weight: 700; }
        .lang-hi-body { font-family: sans-serif; font-weight: 400; }

        #background-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
        }

        .start-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            text-align: center;
            background: linear-gradient(to bottom, #6dd5ed, #2193b0);
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
        }

        .start-screen h1 {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .play-now-btn {
            font-size: 2rem;
            padding: 1rem 3rem;
            border-radius: 50px;
            background: #ff6b6b;
            color: white;
            border: 5px solid white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .play-now-btn:hover {
            transform: scale(1.1);
            background: #ff4757;
        }
        
        #app-container {
            display: none; /* Hidden initially */
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .chapter-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            border: 2px solid rgba(255, 255, 255, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            text-align: center;
            padding: 1.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }
        
        .chapter-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }
        
        .chapter-title {
            color: #fff;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        .modal { background: rgba(0, 0, 0, 0.6); }
        .modal-content {
             background: white;
             border-radius: 1.5rem;
             border: 5px solid #ffca28;
             box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* Generic Game Styles */
        .game-option-btn {
            background-color: #f0f0f0;
            border: 2px solid #ddd;
            transition: all 0.2s ease;
        }
        .game-option-btn:hover {
            transform: scale(1.05);
            border-color: #ffca28;
            background-color: #fffbe6;
        }

        /* Detective Math Game Style */
        .clue-box {
            background: #fffbe6;
            border: 2px dashed #fcd34d;
            padding: 1rem;
            border-radius: 0.75rem;
        }
        
        /* Space Invaders Game Style */
        #invaders-game-area {
            position: relative;
            height: 400px;
            background: #000 url('https://www.transparenttextures.com/patterns/stardust.png');
            border-radius: 1rem;
            overflow: hidden;
        }
        .invader {
            position: absolute;
            color: #39ff14; /* Lime green */
            font-size: 1.5rem;
            animation: fall 10s linear infinite;
            cursor: pointer;
        }
        .player-ship {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 30px;
            background-color: #f9ca24;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        }

        /* Time Traveler Game */
        .number-line {
            width: 100%;
            height: 50px;
            background: #eee;
            border-radius: 25px;
            margin: 2rem 0;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 0 20px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        .time-traveler {
            position: absolute;
            font-size: 2.5rem;
            transition: left 0.5s ease-in-out;
        }
        
        /* Pizza Party Game */
        .pizza-slice {
            fill: #ffdd59;
            stroke: #d35400;
            stroke-width: 4;
            transition: fill 0.3s ease;
            cursor: pointer;
        }
        .pizza-slice:hover {
            fill: #feca57;
        }
        .pizza-crust {
            fill: #d35400;
        }

        /* Market Mayhem Game */
        .item-card {
            background-color: #e0f2fe;
            border: 2px solid #7dd3fc;
        }

        /* Mountain Climber Game */
        .mountain-bg {
            background: linear-gradient(to top, #a8e063, #56ab2f);
            height: 300px;
            position: relative;
            border-radius: 1rem;
            overflow: hidden;
        }
        .climber {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            transition: bottom 0.5s ease-in-out;
            font-size: 2rem;
        }
        .level-marker {
            position: absolute;
            width: 100%;
            left: 0;
            border-top: 1px dashed rgba(255,255,255,0.5);
            color: white;
            font-size: 0.8rem;
            padding-left: 5px;
        }

        /* Polygon Puzzle Game */
        .shape-canvas {
            border: 2px dashed #ccc;
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Variable Voyager Game */
        .voyager-bg {
            background: #000020 url('https://www.transparenttextures.com/patterns/stardust.png');
            height: 250px;
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: white;
            text-shadow: 0 0 10px #00ffff;
        }

        /* Garden Architect Game */
        .garden-plot {
            background-color: #8B4513;
            border: 5px solid #5C2E00;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .dimension-label {
            position: absolute;
            background: rgba(0,0,0,0.5);
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 1rem;
        }

        /* Blueprint Builder Game */
        .tool-icon {
            font-size: 4rem;
        }


        @keyframes fall {
            from { top: -30px; }
            to { top: 100%; }
        }

    </style>
</head>
<body>

    <div id="background-container"></div>

    <div id="start-screen" class="start-screen">
        <h1 class="lang-or">ଷଷ୍ଠ ଶ୍ରେଣୀ ଗଣିତ</h1>
        <p class="text-xl mb-12 lang-or-body">ସାହସିକତାର ପରବର୍ତ୍ତୀ ସ୍ତର!</p>
        <button id="play-now-btn" class="play-now-btn lang-or">ଏବେ ଖେଳନ୍ତୁ</button>
    </div>

    <!-- Main Application Container -->
    <div id="app-container" class="hidden min-h-screen p-4 sm:p-6 lg:p-8">
        <header class="flex justify-between items-center mb-8">
            <h1 id="platform-title" class="text-3xl md:text-4xl font-bold text-white text-shadow">ଷଷ୍ଠ ଶ୍ରେଣୀ ଗଣିତ</h1>
            <div class="flex items-center space-x-2 bg-white/70 backdrop-blur-sm p-2 rounded-full shadow-md">
                <button id="lang-en-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">English</button>
                <button id="lang-or-btn" class="px-4 py-2 rounded-full text-sm font-semibold bg-emerald-500 text-white">ଓଡ଼ିଆ</button>
                <button id="lang-hi-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">हिन्दी</button>
            </div>
        </header>
        <main id="main-content"></main>
    </div>

    <!-- Game Modal -->
    <div id="game-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal">
        <div class="modal-content w-full max-w-4xl max-h-[90vh] rounded-2xl shadow-2xl p-6 relative flex flex-col">
            <div class="flex justify-between items-center pb-4 border-b border-gray-200">
                <h2 id="game-title" class="text-3xl font-bold text-emerald-700">Game Title</h2>
                <button id="close-modal-btn" class="text-gray-500 hover:text-red-600 transition-colors">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="game-content" class="flex-grow mt-4 overflow-y-auto"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- DYNAMIC BACKGROUND GENERATION ---
            function createBackground() {
                const bgContainer = document.getElementById('background-container');
                const svgNS = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(svgNS, "svg");
                svg.setAttribute('width', '100%');
                svg.setAttribute('height', '100%');
                svg.setAttribute('preserveAspectRatio', 'xMidYMid slice');

                // Clouds
                for (let i = 0; i < 15; i++) {
                    const circle = document.createElementNS(svgNS, "circle");
                    circle.setAttribute('cx', `${Math.random() * 100}%`);
                    circle.setAttribute('cy', `${Math.random() * 40}%`);
                    circle.setAttribute('r', `${Math.random() * 50 + 20}`);
                    circle.setAttribute('fill', 'rgba(255, 255, 255, 0.7)');
                    circle.style.filter = 'blur(15px)';
                    svg.appendChild(circle);
                }

                // Floating Islands
                const islandColors = ['#8B4513', '#A0522D', '#D2691E'];
                for (let i = 0; i < 5; i++) {
                    const path = document.createElementNS(svgNS, "path");
                    const x = Math.random() * 80 + 10;
                    const y = Math.random() * 60 + 20;
                    const d = `M ${x-5} ${y} C ${x-10} ${y+10}, ${x+10} ${y+10}, ${x+5} ${y} Z`;
                    path.setAttribute('d', d);
                    path.setAttribute('fill', islandColors[i % 3]);
                    path.style.filter = 'drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4))';
                    svg.appendChild(path);
                }
                bgContainer.appendChild(svg);
            }

            // --- DATA & STATE MANAGEMENT ---
            let currentLanguage = 'or';
            const textContent = {
                platformTitle: { en: '6th Grade Math', or: 'ଷଷ୍ଠ ଶ୍ରେଣୀ ଗଣିତ', hi: 'कक्षा 6 गणित' },
                chapters: [
                    { id: 'ch1', title: { en: 'Knowing Our Numbers', or: 'ସଂଖ୍ୟାମାନଙ୍କୁ ଜାଣିବା', hi: 'अपनी संख्याओं को जानना' }, color: 'bg-blue-500', units: [
                        { id: 'u1.1', title: { en: 'Number Detective', or: 'ସଂଖ୍ୟା ଗୁପ୍ତଚର', hi: 'संख्या जासूस' }, game: 'detectiveMath' },
                        { id: 'u1.2', title: { en: 'Place Value Treasure Hunt', or: 'ସ୍ଥାନୀୟ ମାନର ସନ୍ଧାନ', hi: 'स्थानीय मान खजाना खोज' }, game: 'treasureHunt' }
                    ]},
                    { id: 'ch2', title: { en: 'Playing with Numbers', or: 'ସଂଖ୍ୟା ସହ ଖେଳ', hi: 'संख्याओं के साथ खेलना' }, color: 'bg-green-500', units: [
                        { id: 'u2.1', title: { en: 'Divisibility Space Invaders', or: 'ବିଭାଜ୍ୟତା ମହାକାଶ ଆକ୍ରମଣ', hi: 'विभाज्यता स्पेस आक्रमण' }, game: 'spaceInvaders' },
                        { id: 'u2.2', title: { en: 'Factor Escape Room', or: 'ଗୁଣନୀୟକ ରହସ୍ୟ', hi: 'गुणनखंड एस्केप रूम' }, game: 'escapeRoom' }
                    ]},
                    { id: 'ch3', title: { en: 'Basic Geometrical Ideas', or: 'ଜ୍ୟାମିତିରେ ମୌଳିକ ଧାରଣା', hi: 'बुनियादी ज्यामितीय विचार' }, color: 'bg-yellow-500', units: [
                         { id: 'u3.1', title: { en: 'Shape Magic', or: 'ଆକୃତିର ଯାଦୁ', hi: 'आकृति का जादू' }, game: 'shapeMagic' }
                    ]},
                    { id: 'ch4', title: { en: 'Natural Numbers', or: 'ସ୍ଵାଭାବିକ ସଂଖ୍ୟା', hi: 'प्राकृतिक संख्याएं' }, color: 'bg-purple-500', units: [
                         { id: 'u4.1', title: { en: 'Time Traveler', or: 'ସମୟ ଯାତ୍ରା', hi: 'समय यात्री' }, game: 'timeTraveler' }
                    ]},
                    { id: 'ch5', title: { en: 'Fractions', or: 'ଭଗ୍ନସଂଖ୍ୟା', hi: 'भिन्न' }, color: 'bg-pink-500', units: [
                        { id: 'u5.1', title: { en: 'Pizza Party', or: 'ପିଜା ପାର୍ଟି', hi: 'पिज्जा पार्टी' }, game: 'pizzaParty' }
                    ]},
                    { id: 'ch6', title: { en: 'Decimal Numbers', or: 'ଦଶମିକ ସଂଖ୍ୟା', hi: 'दशमलव संख्याएं' }, color: 'bg-indigo-500', units: [
                        { id: 'u6.1', title: { en: 'Decimal Dash', or: 'ଦଶମିକ ଦୌଡ଼', hi: 'दशमलव डैश' }, game: 'decimalDash' }
                    ]},
                    { id: 'ch7', title: { en: 'Commercial Mathematics', or: 'ବ୍ୟାବସାୟିକ ଗଣିତ', hi: 'व्यावसायिक गणित' }, color: 'bg-red-500', units: [
                        { id: 'u7.1', title: { en: 'Market Mayhem', or: 'ବଜାରର ମାୟା', hi: 'बाजार की माया' }, game: 'marketMayhem' }
                    ]},
                    { id: 'ch8', title: { en: 'Integers', or: 'ପୂର୍ଣ୍ଣ ସଂଖ୍ୟା', hi: 'पूर्णांक' }, color: 'bg-orange-500', units: [
                        { id: 'u8.1', title: { en: 'Mountain Climber', or: 'ପର୍ବତାରୋହୀ', hi: 'पर्वतारोही' }, game: 'mountainClimber'}
                    ]},
                    { id: 'ch9', title: { en: 'Geometrical Shapes on a Plane', or: 'ସମତଳ ଉପରିସ୍ଥ ଜ୍ୟାମିତିକ ଆକୃତି', hi: 'एक तल पर ज्यामितीय आकृतियाँ' }, color: 'bg-cyan-500', units: [
                        { id: 'u9.1', title: { en: 'Polygon Puzzle', or: 'ବହୁଭୁଜ ପଜଲ୍', hi: 'बहुभुज पहेली' }, game: 'polygonPuzzle'}
                    ]},
                    { id: 'ch10', title: { en: 'Introduction to Algebra', or: 'ବୀଜଗଣିତ ସହିତ ପରିଚିତି', hi: 'बीजगणित का परिचय' }, color: 'bg-lime-500', units: [
                        { id: 'u10.1', title: { en: 'Variable Voyager', or: 'ବେରିଏବଲ୍ ଭଏଜର୍', hi: 'चर वोयाजर' }, game: 'variableVoyager'}
                    ]},
                    { id: 'ch11', title: { en: 'Mensuration', or: 'ପରିମିତି', hi: 'क्षेत्रमिति' }, color: 'bg-fuchsia-500', units: [
                        { id: 'u11.1', title: { en: 'Garden Architect', or: 'ବଗିଚା ନିର୍ମାତା', hi: 'बगीचा निर्माता' }, game: 'gardenArchitect'}
                    ]},
                    { id: 'ch12', title: { en: 'Data Handling and Organization', or: 'ତଥ୍ୟ ପରିଚାଳନା ଓ ସଂରଚନା', hi: 'डेटा प्रबंधन और संगठन' }, color: 'bg-rose-500', units: [
                        { id: 'u12.1', title: { en: 'Fruit Stand Frenzy', or: 'ଫଳ ଦୋକାନ ମଜା', hi: 'फल दुकान का मज़ा' }, game: 'fruitStandFrenzy'}
                    ]},
                    { id: 'ch13', title: { en: 'Geometrical Constructions', or: 'ଜ୍ୟାମିତିକ ଅଙ୍କନ', hi: 'ज्यामितीय निर्माण' }, color: 'bg-sky-500', units: [
                        { id: 'u13.1', title: { en: 'Blueprint Builder', or: 'ନକ୍ସା ନିର୍ମାତା', hi: 'ब्लूप्रिंट बिल्डर' }, game: 'blueprintBuilder'}
                    ]}
                ]
            };
            
            const gameData = {
                checkAnswer: { en: 'Check', or: 'ଯାଞ୍ଚ କରନ୍ତୁ', hi: 'जांचें' },
                correct: { en: 'Brilliant!', or: 'ବହୁତ ବଢିଆ!', hi: 'बहुत बढ़िया!' },
                tryAgain: { en: 'Not quite, try again!', or: 'ଭୁଲ ଅଛି, ପୁଣି ଚେଷ୍ଟା କରନ୍ତୁ!', hi: 'गलत है, फिर से कोशिश करें!' },
                next: { en: 'Next', or: 'ପରବର୍ତ୍ତୀ', hi: 'अगला' },
                detectiveMath: {
                    instruction: { en: 'Detective, find the missing number in the sequence!', or: 'ଗୁପ୍ତଚର, ଏହି କ୍ରମରେ ଥିବା ହଜିଯାଇଥିବା ସଂଖ୍ୟାକୁ ଖୋଜନ୍ତୁ!', hi: 'जासूस, इस क्रम में लुप्त संख्या ज्ञात करें!' },
                    caseFile: { en: 'Case File', or: 'କେସ୍ ଫାଇଲ୍', hi: 'केस फ़ाइल' }
                },
                treasureHunt: {
                    instruction: { en: 'Brave adventurer, find the treasure! What digit is in the', or: 'ସାହସୀ ଅଭିଯାତ୍ରୀ, ଧନ ସନ୍ଧାନ କର! କେଉଁ ଅଙ୍କଟି ଏହି ସ୍ଥାନରେ ଅଛି', hi: 'बहादुर साहसी, खजाना ढूंढो! कौन सा अंक इस स्थान पर है' },
                    place: {
                        ones: { en: 'Ones place', or: 'ଏକକ ସ୍ଥାନରେ', hi: 'इकाई स्थान पर'},
                        tens: { en: 'Tens place', or: 'ଦଶକ ସ୍ଥାନରେ', hi: 'दहाई स्थान पर'},
                        hundreds: { en: 'Hundreds place', or: 'ଶତକ ସ୍ଥାନରେ', hi: 'सैकड़ा स्थान पर'},
                        thousands: { en: 'Thousands place', or: 'ହଜାର ସ୍ଥାନରେ', hi: 'हजार स्थान पर' },
                        tenThousands: { en: 'Ten Thousands place', or: 'ଅୟୁତ ସ୍ଥାନରେ', hi: 'दस हजार स्थान पर' },
                        lakhs: { en: 'Lakhs place', or: 'ଲକ୍ଷ ସ୍ଥାନରେ', hi: 'लाख स्थान पर' }
                    },
                    inTheNumber: { en: 'in the number', or: 'ସଂଖ୍ୟାଟିରେ', hi: 'संख्या में' }
                },
                spaceInvaders: {
                    instruction: { en: 'Destroy the invaders that are multiples of', or: 'ଆକ୍ରମଣକାରୀଙ୍କୁ ନଷ୍ଟ କରନ୍ତୁ ଯେଉଁମାନେ ଏହାର ଗୁଣିତକ ଅଟନ୍ତି', hi: 'उन आक्रमणकारियों को नष्ट करें जो इसके गुणज हैं' },
                    fire: { en: 'FIRE!', or: 'ଫାୟାର!', hi: 'फ़ायर!' }
                },
                escapeRoom: {
                    instruction: { en: 'Find the key! Which of these is a factor of', or: 'ଚାବି ଖୋଜ! ଏମାନଙ୍କ ମଧ୍ୟରୁ କେଉଁଟି ଏହାର ଗୁଣନୀୟକ', hi: 'चाबी ढूंढो! इनमें से कौन इसका गुणनखंड है' }
                },
                shapeMagic: {
                    instruction: { en: 'What am I?', or: 'ମୁଁ କିଏ?', hi: 'मैं क्या हूँ?' },
                    questions: [
                        { q: { en: 'I have no size, only a position.', or: 'ମୋର ଆକାର ନାହିଁ, କେବଳ ଏକ ସ୍ଥିତି ଅଛି |', hi: 'मेरा कोई आकार नहीं है, केवल एक स्थिति है।' }, o: [{ en: 'Line', or: 'ରେଖା', hi: 'रेखा' }, { en: 'Point', or: 'ବିନ୍ଦୁ', hi: 'बिंदु' }, { en: 'Ray', or: 'ରଶ୍ମି', hi: 'किरण' }], a: 1 },
                        { q: { en: 'I have two endpoints and a fixed length.', or: 'ମୋର ଦୁଇଟି ପ୍ରାନ୍ତବିନ୍ଦୁ ଏବଂ ଏକ ନିର୍ଦ୍ଦିଷ୍ଟ ଦୈର୍ଘ୍ୟ ଅଛି |', hi: 'मेरे दो अंत बिंदु और एक निश्चित लंबाई है।' }, o: [{ en: 'Line Segment', or: 'ରେଖାଖଣ୍ଡ', hi: 'रेखा खंड' }, { en: 'Line', or: 'ରେଖା', hi: 'रेखा' }, { en: 'Angle', or: 'କୋଣ', hi: 'कोण' }], a: 0 },
                        { q: { en: 'We are lines in the same plane that never meet.', or: 'ଆମେ ଗୋଟିଏ ସମତଳରେ ଥିବା ରେଖା ଯାହା କେବେବି ସାକ୍ଷାତ କରେ ନାହିଁ |', hi: 'हम एक ही तल में रेखाएँ हैं जो कभी नहीं मिलतीं।' }, o: [{ en: 'Intersecting Lines', or: 'ଛେଦି ରେଖା', hi: 'प्रतिच्छेदी रेखाएँ' }, { en: 'Rays', or: 'ରଶ୍ମି', hi: 'किरणें' }, { en: 'Parallel Lines', or: 'ସମାନ୍ତର ରେଖା', hi: 'समानांतर रेखाएँ' }], a: 2 }
                    ]
                },
                timeTraveler: {
                    instruction: { en: "Enter the year you'll land in!", or: "ତୁମେ କେଉଁ ବର୍ଷରେ ପହଞ୍ଚିବ ଲେଖ!", hi: "आप किस वर्ष में उतरेंगे, दर्ज करें!" },
                    mission: { en: 'Mission:', or: 'ମିଶନ୍:', hi: 'मिशन:' },
                    start: { en: 'You are in the year', or: 'ତୁମେ ବର୍ତ୍ତମାନ ଅଛ', hi: 'आप वर्ष में हैं' },
                    travel: { en: 'Travel', or: 'ଯାତ୍ରା କର', hi: 'यात्रा करें' },
                    yearsFuture: { en: 'years into the future!', or: 'ବର୍ଷ ଭବିଷ୍ୟତକୁ!', hi: 'वर्ष भविष्य में!' },
                    yearsPast: { en: 'years into the past!', or: 'ବର୍ଷ ଅତୀତକୁ!', hi: 'वर्ष अतीत में!' }
                },
                pizzaParty: {
                    instruction: { en: 'Click on the slices to make the fraction', or: 'ଭଗ୍ନସଂଖ୍ୟା ତିଆରି କରିବା ପାଇଁ ସ୍ଲାଇସ୍ ଉପରେ କ୍ଲିକ୍ କରନ୍ତୁ', hi: 'भिन्न बनाने के लिए स्लाइस पर क्लिक करें' },
                },
                decimalDash: {
                    instruction: { en: 'Which is the correct decimal for', or: 'ଏଥିପାଇଁ ସଠିକ୍ ଦଶମିକ କେଉଁଟି?', hi: 'इसके लिए सही दशमलव कौन सा है?' },
                },
                marketMayhem: {
                    instruction: { en: 'You have ₹100. Can you buy these items?', or: 'ତୁମ ପାଖରେ ₹100 ଅଛି। ତୁମେ ଏହି ଜିନିଷଗୁଡ଼ିକ କିଣି ପାରିବ କି?', hi: 'आपके पास ₹100 हैं। क्या आप ये वस्तुएँ खरीद सकते हैं?' },
                    calculate: { en: 'Calculate Total', or: 'ମୋଟ ହିସାବ କରନ୍ତୁ', hi: 'कुल की गणना करें' },
                    yes: { en: 'Yes!', or: 'ହଁ!', hi: 'हाँ!' },
                    no: { en: 'No!', or: 'ନା!', hi: 'नहीं!' },
                    total: { en: 'Total:', or: 'ମୋଟ:', hi: 'कुल:' }
                },
                mountainClimber: {
                    instruction: { en: 'Calculate your new altitude!', or: 'ତୁମର ନୂଆ ଉଚ୍ଚତା ଗଣନା କରନ୍ତୁ!', hi: 'अपनी नई ऊंचाई की गणना करें!' },
                    start: { en: 'You are at', or: 'ତୁମେ ଅଛ', hi: 'आप पर हैं' },
                    change: { en: 'A gust of wind moves you', or: 'ଏକ ପବନ ତୁମକୁ ନେଇଯାଏ', hi: 'हवा का एक झोंका आपको ले जाता है' },
                    up: { en: 'm up.', or: 'ମିଟର ଉପରକୁ।', hi: 'मीटर ऊपर।' },
                    down: { en: 'm down.', or: 'ମିଟର ତଳକୁ।', hi: 'मीटर नीचे।' },
                    question: { en: 'What is your new position?', or: 'ତୁମର ନୂଆ ସ୍ଥିତି କ’ଣ?', hi: 'आपकी नई स्थिति क्या है?' }
                },
                polygonPuzzle: {
                    instruction: { en: 'Answer the question about the shape!', or: 'ଆକୃତି ବିଷୟରେ ପ୍ରଶ୍ନର ଉତ୍ତର ଦିଅନ୍ତୁ!', hi: 'आकृति के बारे में प्रश्न का उत्तर दें!' },
                    questions: [
                          { q: { en: 'Which of these is a simple closed curve?', or: 'ଏମାନଙ୍କ ମଧ୍ୟରୁ କେଉଁଟି ଏକ ସରଳ ବନ୍ଦ ବକ୍ରରେଖା?', hi: 'इनमें से कौन सा एक साधारण बंद वक्र है?' }, o: [{ en: 'A smiling face', or: 'ଏକ ହସୁଥିବା ଚେହେରା', hi: 'एक मुस्कुराता हुआ चेहरा' }, { en: 'A figure eight', or: 'ଏକ ଆଠ ଆକୃତି', hi: 'एक आठ का आंकड़ा' }, { en: 'A triangle', or: 'ଏକ ତ୍ରିଭୁଜ', hi: 'एक त्रिभुज' }], a: 2 },
                          { q: { en: 'How many sides does a quadrilateral have?', or: 'ଏକ ଚତୁର୍ଭୁଜର କେତୋଟି ପାର୍ଶ୍ଵ ଅଛି?', hi: 'एक चतुर्भुज की कितनी भुजाएँ होती हैं?' }, o: [{ en: '3', or: '୩', hi: '३' }, { en: '4', or: '୪', hi: '४' }, { en: '5', or: '୫', hi: '५' }], a: 1 },
                          { q: { en: 'What do you call a polygon with 5 sides?', or: '୫ଟି ପାର୍ଶ୍ଵ ଥିବା ବହୁଭୁଜକୁ କ’ଣ କୁହାଯାଏ?', hi: '५ भुजाओं वाले बहुभुज को क्या कहते हैं?' }, o: [{ en: 'Hexagon', or: 'ଷଡ଼ଭୁଜ', hi: 'षट्कोण' }, { en: 'Pentagon', or: 'ପଞ୍ଚଭୁଜ', hi: 'पंचकोण' }, { en: 'Octagon', or: 'ଅଷ୍ଟଭୁଜ', hi: 'अष्टकोण' }], a: 1 }
                    ]
                },
                variableVoyager: {
                    instruction: { en: 'Find the value of X to guide the rocket!', or: 'ରକେଟକୁ ମାର୍ଗଦର୍ଶନ କରିବା ପାଇଁ Xର ମୂଲ୍ୟ ଖୋଜନ୍ତୁ!', hi: 'रॉकेट का मार्गदर्शन करने के लिए X का मान ज्ञात करें!' },
                    solve: { en: 'Solve:', or: 'ସମାଧାନ କରନ୍ତୁ:', hi: 'हल करें:' },
                },
                gardenArchitect: {
                    instruction: { en: 'Calculate what the architect needs!', or: 'ସ୍ଥପତିଙ୍କୁ କ’ଣ ଦରକାର ତାହା ଗଣନା କରନ୍ତୁ!', hi: 'वास्तुकार को क्या चाहिए, उसकी गणना करें!' },
                    question_perimeter: { en: 'How much fencing is needed for this garden (Perimeter)?', or: 'ଏହି ବଗିଚା ପାଇଁ କେତେ ବାଡ଼ ଦରକାର (ପରିସୀମା)?', hi: 'इस बगीचे के लिए कितनी बाड़ की आवश्यकता है (परिधि)?' },
                    question_area: { en: 'How much space is there for seeds (Area)?', or: 'ବୀଜ ପାଇଁ କେତେ ଜାଗା ଅଛି (କ୍ଷେତ୍ରଫଳ)?', hi: 'बीज के लिए कितनी जगह है (क्षेत्रफल)?' },
                    unit: { en: 'm', or: 'ମି', hi: 'मी' },
                    unit_sq: { en: 'sq. m', or: 'ବର୍ଗ ମି', hi: 'वर्ग मी' }
                },
                fruitStandFrenzy: {
                    instruction: { en: 'Answer the questions based on the fruit sales chart!', or: 'ଫଳ ବିକ୍ରି ଚାର୍ଟ ଉପରେ ଆଧାର କରି ପ୍ରଶ୍ନଗୁଡ଼ିକର ଉତ୍ତର ଦିଅନ୍ତୁ!', hi: 'फलों की बिक्री चार्ट के आधार पर प्रश्नों के उत्तर दें!' },
                    questions: [
                        { q: { en: 'Which fruit was sold the most?', or: 'କେଉଁ ଫଳ ସବୁଠାରୁ ଅଧିକ ବିକ୍ରି ହୋଇଥିଲା?', hi: 'कौन सा फल सबसे ज्यादा बिका?' }, o: [{ en: 'Apples', or: 'ସେଓ', hi: 'सेब' }, { en: 'Bananas', or: 'କଦଳୀ', hi: 'केले' }, { en: 'Oranges', or: 'କମଳା', hi: 'संतरे' }], a: 1 },
                        { q: { en: 'How many fruits were sold in total?', or: 'ମୋଟ କେତୋଟି ଫଳ ବିକ୍ରି ହୋଇଥିଲା?', hi: 'कुल कितने फल बिके?' }, o: [20, 25, 30], a: 2 }
                    ]
                },
                blueprintBuilder: {
                    instruction: { en: 'To perform this construction, which tool is essential?', or: 'ଏହି ନିର୍ମାଣ କରିବା ପାଇଁ, କେଉଁ ଉପକରଣଟି ଅତ୍ୟାବଶ୍ୟକ?', hi: 'इस निर्माण को करने के लिए, कौन सा उपकरण आवश्यक है?' },
                    questions: [
                        { q: { en: 'Constructing a circle of radius 5cm', or: '5 ସେମି ବ୍ୟାସାର୍ଦ୍ଧର ଏକ ବୃତ୍ତ ନିର୍ମାଣ', hi: '5 सेमी त्रिज्या का एक वृत्त बनाना' }, o: [{ en: 'Ruler', or: 'ସ୍କେଲ୍', hi: 'रूलर' }, { en: 'Compass', or: 'କମ୍ପାସ୍', hi: 'कम्पास' }, { en: 'Protractor', or: 'ପ୍ରୋଟ୍ରାକ୍ଟର୍', hi: 'प्रोटेक्टर' }], a: 1 },
                        { q: { en: 'Drawing a line segment of length 7cm', or: '7 ସେମି ଦୈର୍ଘ୍ୟର ଏକ ରେଖାଖଣ୍ଡ ଅଙ୍କନ', hi: '7 सेमी लंबाई का एक रेखा खंड खींचना' }, o: [{ en: 'Ruler', or: 'ସ୍କେଲ୍', hi: 'रूलर' }, { en: 'Compass', or: 'କମ୍ପାସ୍', hi: 'कम्पास' }, { en: 'Set-square', or: 'ସେଟ୍-ସ୍କୋୟାର', hi: 'सेट-स्क्वायर' }], a: 0 }
                    ]
                }
            };

            // --- UI ELEMENTS ---
            const startScreen = document.getElementById('start-screen');
            const playNowBtn = document.getElementById('play-now-btn');
            const appContainer = document.getElementById('app-container');
            const mainContent = document.getElementById('main-content');
            const platformTitle = document.getElementById('platform-title');
            const langEnBtn = document.getElementById('lang-en-btn');
            const langOrBtn = document.getElementById('lang-or-btn');
            const langHiBtn = document.getElementById('lang-hi-btn');
            const gameModal = document.getElementById('game-modal');
            const gameTitle = document.getElementById('game-title');
            const gameContent = document.getElementById('game-content');
            const closeModalBtn = document.getElementById('close-modal-btn');

            // --- RENDER FUNCTIONS ---
            
            function renderChapters() {
                mainContent.innerHTML = `
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6 md:gap-8 overflow-y-auto h-[calc(100vh-120px)] pb-12 pr-4">
                        ${textContent.chapters.map(chapter => `
                            <div id="${chapter.id}" class="chapter-card">
                                <div class="text-white p-4 rounded-lg ${chapter.color}">
                                    <h2 class="text-2xl font-bold mb-2 chapter-title lang-${currentLanguage}">${chapter.title[currentLanguage]}</h2>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            function renderUnits(chapterId) {
                const chapter = textContent.chapters.find(c => c.id === chapterId);
                mainContent.innerHTML = `
                    <div class="flex items-center mb-6">
                        <button id="back-to-chapters" class="mr-4 p-2 rounded-full bg-white/50 hover:bg-white/80 transition-colors">
                            <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                        </button>
                        <h2 class="text-3xl font-bold text-white text-shadow lang-${currentLanguage}">${chapter.title[currentLanguage]}</h2>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        ${chapter.units.map(unit => `
                            <button data-game="${unit.game || 'none'}" data-unit-id="${unit.id}" class="unit-button w-full text-left p-4 rounded-xl shadow-md text-white font-semibold ${chapter.color} ${unit.game && unit.game !== 'comingSoon' ? '' : 'opacity-50 cursor-not-allowed'} hover:scale-105 transition-transform">
                                <span class="lang-${currentLanguage}">${unit.title[currentLanguage]}</span>
                            </button>
                        `).join('')}
                    </div>
                `;
            }

            // --- GAME IMPLEMENTATIONS ---
            const games = {
                detectiveMath: {
                    init() {
                        const sequence = [2, 4, '?', 8, 10];
                        gameTitle.textContent = textContent.chapters[0].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.detectiveMath.instruction[currentLanguage]}</p>
                            <div class="clue-box my-6">
                                <p class="text-sm text-gray-500 lang-${currentLanguage}">${gameData.detectiveMath.caseFile[currentLanguage]}</p>
                                <div class="text-center text-4xl font-bold tracking-wider my-4">${sequence.join(' &nbsp; ')}</div>
                            </div>
                            <div class="flex justify-center items-center gap-4">
                                <input id="game-answer" type="number" class="p-2 text-2xl text-center w-24 border-2 rounded-lg" />
                                <button id="check-btn" class="px-6 py-3 bg-blue-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;

                        document.getElementById('check-btn').addEventListener('click', () => {
                            const answer = document.getElementById('game-answer').value;
                            showFeedback(parseInt(answer) === 6, () => this.init());
                        });
                    }
                },
                treasureHunt: {
                    init() {
                        const numberStr = "4,81,716";
                        const quests = [
                            { place: 'lakhs', answer: 4 },
                            { place: 'tenThousands', answer: 8 },
                            { place: 'thousands', answer: 1 },
                            { place: 'hundreds', answer: 7 },
                            { place: 'tens', answer: 1 },
                            { place: 'ones', answer: 6 }
                        ];
                        const currentQuest = quests[Math.floor(Math.random() * quests.length)];

                        let options = new Set([currentQuest.answer]);
                        while (options.size < 3) {
                            options.add(Math.floor(Math.random() * 10));
                        }
                        const shuffledOptions = Array.from(options).sort(() => Math.random() - 0.5);

                        gameTitle.textContent = textContent.chapters[0].units[1].title[currentLanguage];
                        gameContent.innerHTML = `
                            <div class="p-4 rounded-lg" style="background-color: #F3E9D2; border: 3px solid #C68B59;">
                                <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">
                                    ${gameData.treasureHunt.instruction[currentLanguage]} <strong>${gameData.treasureHunt.place[currentQuest.place][currentLanguage]}</strong> ${gameData.treasureHunt.inTheNumber[currentLanguage]}...
                                </p>
                                <p class="text-center text-5xl font-bold my-6" style="font-family: 'Courier New', monospace; color: #5C2E00;">${numberStr}</p>
                            </div>
                            <div class="flex justify-center items-center gap-6 my-8">
                                ${shuffledOptions.map(opt => `
                                    <button class="game-option-btn p-6 rounded-full text-2xl font-bold bg-yellow-500 text-white border-4 border-yellow-700 hover:bg-yellow-600 transition-all" data-correct="${opt === currentQuest.answer}">${opt}</button>
                                `).join('')}
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;

                        gameContent.querySelectorAll('.game-option-btn').forEach(btn => {
                            btn.addEventListener('click', e => {
                                showFeedback(e.currentTarget.dataset.correct === 'true', () => this.init());
                            });
                        });
                    }
                },
                 spaceInvaders: {
                    init() {
                        const targetMultiple = 7;
                        gameTitle.textContent = textContent.chapters[1].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.spaceInvaders.instruction[currentLanguage]} <strong>${targetMultiple}</strong></p>
                            <div id="invaders-game-area">
                                <div class="player-ship"></div>
                            </div>
                            <div class="text-center mt-4">
                                <p class="text-sm text-gray-500 lang-${currentLanguage}-body">Click on the correct falling numbers!</p>
                            </div>
                             <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        
                        const gameArea = document.getElementById('invaders-game-area');
                        
                        for(let i=0; i<10; i++){
                            const invader = document.createElement('div');
                            invader.className = 'invader';
                            const num = Math.floor(Math.random() * 50) + 1;
                            invader.textContent = num;
                            invader.style.left = `${Math.random() * 90}%`;
                            invader.style.animationDuration = `${Math.random() * 5 + 5}s`;
                            invader.style.animationDelay = `${Math.random() * 10}s`;
                            invader.addEventListener('click', () => {
                                const isCorrect = num % targetMultiple === 0;
                                if(isCorrect) {
                                   invader.style.color = '#feca57';
                                   invader.textContent = '💥';
                                   setTimeout(()=> invader.remove(), 500);
                                }
                                showFeedback(isCorrect, () => {});
                            });
                            gameArea.appendChild(invader);
                        }
                    }
                },
                escapeRoom: {
                    init() {
                        const numberToFactor = 48;
                        const keys = [12, 15, 7];
                        const correctKey = 12;

                        gameTitle.textContent = textContent.chapters[1].units[1].title[currentLanguage];
                        gameContent.innerHTML = `
                             <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.escapeRoom.instruction[currentLanguage]} <strong>${numberToFactor}</strong>?</p>
                             <div class="flex justify-center items-center gap-6 my-8">
                                 ${keys.map(key => `
                                     <button class="key-btn p-6 bg-yellow-400 rounded-full text-2xl font-bold hover:bg-yellow-500 transition-colors" data-key="${key}">🔑 ${key}</button>
                                 `).join('')}
                             </div>
                             <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        document.querySelectorAll('.key-btn').forEach(btn => {
                            btn.addEventListener('click', () => {
                                const isCorrect = parseInt(btn.dataset.key) === correctKey;
                                showFeedback(isCorrect, () => this.init());
                            });
                        });
                    }
                },
                shapeMagic: {
                    init() {
                        const questionData = gameData.shapeMagic.questions;
                        const q = questionData[Math.floor(Math.random() * questionData.length)];
                        
                        gameTitle.textContent = textContent.chapters[2].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-2xl font-bold my-6 lang-${currentLanguage}-body">"${q.q[currentLanguage]}"</p>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                ${q.o.map((opt, index) => `
                                    <button class="game-option-btn p-4 rounded-lg text-xl" data-correct="${index === q.a}">
                                        <span class="lang-${currentLanguage}-body">${opt[currentLanguage]}</span>
                                    </button>
                                `).join('')}
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        
                        gameContent.querySelectorAll('.game-option-btn').forEach(btn => {
                            btn.addEventListener('click', e => {
                                showFeedback(e.currentTarget.dataset.correct === 'true', () => this.init());
                            });
                        });
                    }
                },
                timeTraveler: {
                    init() {
                        const startYear = Math.floor(Math.random() * 50) + 10;
                        const travelTime = Math.floor(Math.random() * 10) + 2;
                        const isFuture = Math.random() > 0.5;
                        const endYear = isFuture ? startYear + travelTime : startYear - travelTime;

                        gameTitle.textContent = textContent.chapters[3].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <div class="text-center">
                                <p class="text-lg lang-${currentLanguage}-body">${gameData.timeTraveler.start[currentLanguage]} <strong>${startYear}</strong>.</p>
                                <p class="text-xl font-bold my-4 lang-${currentLanguage}-body">${gameData.timeTraveler.mission[currentLanguage]} ${gameData.timeTraveler.travel[currentLanguage]} <strong>${travelTime}</strong> ${isFuture ? gameData.timeTraveler.yearsFuture[currentLanguage] : gameData.timeTraveler.yearsPast[currentLanguage]}</p>
                            </div>
                            <div class="number-line">
                                <span class="font-bold text-gray-600">${startYear - travelTime - 2}</span>
                                <span class="font-bold text-gray-600">...</span>
                                <div class="time-traveler" style="left: 48%;">🚀</div>
                                <span class="font-bold text-gray-600">...</span>
                                <span class="font-bold text-gray-600">${startYear + travelTime + 2}</span>
                            </div>
                             <div class="flex justify-center items-center gap-4">
                                <input id="game-answer" type="number" class="p-2 text-2xl text-center w-24 border-2 rounded-lg" />
                                <button id="check-btn" class="px-6 py-3 bg-purple-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        
                        document.getElementById('check-btn').addEventListener('click', () => {
                            const answer = document.getElementById('game-answer').value;
                            showFeedback(parseInt(answer) === endYear, () => this.init());
                        });
                    }
                },
                 pizzaParty: {
                    init() {
                        const numerator = 3;
                        const denominator = 8;
                        gameTitle.textContent = textContent.chapters[4].units[0].title[currentLanguage];
                        
                        let slicesHTML = '';
                        for (let i = 0; i < denominator; i++) {
                            const angle = (i / denominator) * 360;
                            const x1 = 100 + 90 * Math.cos((angle - 90) * Math.PI / 180);
                            const y1 = 100 + 90 * Math.sin((angle - 90) * Math.PI / 180);
                            const x2 = 100 + 90 * Math.cos((angle - 90 + 360/denominator) * Math.PI / 180);
                            const y2 = 100 + 90 * Math.sin((angle - 90 + 360/denominator) * Math.PI / 180);
                            slicesHTML += `<path class="pizza-slice" d="M100,100 L${x1},${y1} A90,90 0 0,1 ${x2},${y2} Z" data-selected="false"></path>`;
                        }

                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.pizzaParty.instruction[currentLanguage]} <strong class="text-2xl">${numerator}/${denominator}</strong></p>
                            <div class="flex justify-center my-4">
                                <svg viewBox="0 0 200 200" width="250" height="250">
                                    <circle cx="100" cy="100" r="95" class="pizza-crust" />
                                    ${slicesHTML}
                                </svg>
                            </div>
                            <div class="flex justify-center">
                                <button id="check-btn" class="px-6 py-3 bg-pink-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;

                        document.querySelectorAll('.pizza-slice').forEach(slice => {
                            slice.addEventListener('click', () => {
                                const isSelected = slice.dataset.selected === 'true';
                                slice.dataset.selected = !isSelected;
                                slice.style.fill = !isSelected ? '#feca57' : '#ffdd59';
                            });
                        });
                        
                        document.getElementById('check-btn').addEventListener('click', () => {
                            const selectedCount = document.querySelectorAll('.pizza-slice[data-selected="true"]').length;
                            showFeedback(selectedCount === numerator, () => this.init());
                        });
                    }
                },
                decimalDash: {
                    init() {
                        const fraction = {n: 7, d: 10};
                        const decimal = 0.7;
                        const options = [0.07, 7.0, 0.7].sort(() => Math.random() - 0.5);
                        gameTitle.textContent = textContent.chapters[5].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-2xl font-bold my-6 lang-${currentLanguage}-body">${gameData.decimalDash.instruction[currentLanguage]} <strong>${fraction.n}/${fraction.d}</strong>?</p>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                ${options.map(opt => `
                                    <button class="game-option-btn p-6 rounded-lg text-2xl" data-correct="${opt === decimal}">
                                        ${opt}
                                    </button>
                                `).join('')}
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        
                        gameContent.querySelectorAll('.game-option-btn').forEach(btn => {
                            btn.addEventListener('click', e => {
                                showFeedback(e.currentTarget.dataset.correct === 'true', () => this.init());
                            });
                        });
                    }
                },
                marketMayhem: {
                    init() {
                        const items = [{n:{en:'Apples', or:'ସେଓ', hi: 'सेब'}, p: 45.50}, {n:{en:'Milk', or:'କ୍ଷୀର', hi: 'दूध'}, p: 25.00}, {n:{en:'Bread', or:'ପାଉଁରୁଟି', hi: 'ब्रेड'}, p: 32.75}];
                        const total = items.reduce((sum, item) => sum + item.p, 0);
                        gameTitle.textContent = textContent.chapters[6].units[0].title[currentLanguage];

                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.marketMayhem.instruction[currentLanguage]}</p>
                            <div class="grid grid-cols-3 gap-4 my-6">
                                ${items.map(item => `
                                    <div class="item-card p-4 rounded-lg text-center">
                                        <p class="text-xl lang-${currentLanguage}-body">${item.n[currentLanguage]}</p>
                                        <p class="text-2xl font-bold">₹${item.p.toFixed(2)}</p>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="text-center">
                                <button id="check-btn" class="px-6 py-3 bg-red-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.marketMayhem.calculate[currentLanguage]}</button>
                            </div>
                             <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        
                        document.getElementById('check-btn').addEventListener('click', () => {
                            const feedback = document.getElementById('feedback-container');
                            const canAfford = total <= 100;
                            feedback.innerHTML = `
                                <p class="text-xl">${gameData.marketMayhem.total[currentLanguage]} ₹${total.toFixed(2)}</p>
                                <p class="text-3xl font-bold ${canAfford ? 'text-green-600' : 'text-red-600'}">${canAfford ? gameData.marketMayhem.yes[currentLanguage] : gameData.marketMayhem.no[currentLanguage]}</p>
                            `;
                        });
                    }
                },
                 mountainClimber: {
                    init() {
                        const start = Math.floor(Math.random() * 11) - 5; // -5 to +5
                        const change = Math.floor(Math.random() * 10) + 1; // 1 to 10
                        const isUp = Math.random() > 0.5;
                        const end = isUp ? start + change : start - change;

                        gameTitle.textContent = textContent.chapters[7].units[0].title[currentLanguage];

                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-2 lang-${currentLanguage}-body">${gameData.mountainClimber.instruction[currentLanguage]}</p>
                            <div class="flex justify-around items-center">
                                <div class="w-2/3">
                                    <p class="text-md my-2 lang-${currentLanguage}-body">${gameData.mountainClimber.start[currentLanguage]} <strong>${start > 0 ? '+' : ''}${start}m</strong>.</p>
                                    <p class="text-md my-2 lang-${currentLanguage}-body">${gameData.mountainClimber.change[currentLanguage]} <strong>${change}</strong> ${isUp ? gameData.mountainClimber.up[currentLanguage] : gameData.mountainClimber.down[currentLanguage]}</p>
                                    <p class="text-lg font-bold my-4 lang-${currentLanguage}-body">${gameData.mountainClimber.question[currentLanguage]}</p>
                                    <div class="flex items-center gap-4">
                                        <input id="game-answer" type="number" class="p-2 text-2xl text-center w-24 border-2 rounded-lg" />
                                        <button id="check-btn" class="px-6 py-3 bg-orange-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                                    </div>
                                </div>
                                <div class="w-1/3 mountain-bg">
                                    <div class="level-marker" style="bottom: 50%;"><span class="bg-black/20 px-1 rounded">0m</span></div>
                                    <div class="climber" style="bottom: calc(50% + ${start * 5}px);">🧗</div>
                                </div>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;

                        document.getElementById('check-btn').addEventListener('click', () => {
                            const answer = document.getElementById('game-answer').value;
                            const isCorrect = parseInt(answer) === end;
                            showFeedback(isCorrect, () => this.init());
                            if (isCorrect) {
                                document.querySelector('.climber').style.bottom = `calc(50% + ${end * 5}px)`;
                            }
                        });
                    }
                },
                polygonPuzzle: {
                    init() {
                        const questionData = gameData.polygonPuzzle.questions;
                        const q = questionData[Math.floor(Math.random() * questionData.length)];
                        
                        gameTitle.textContent = textContent.chapters[8].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-2xl font-bold my-4 lang-${currentLanguage}-body">${q.q[currentLanguage]}</p>
                            <div class="shape-canvas h-48 my-4">
                                <!-- Visuals can be added here with SVG -->
                                <p class="text-5xl">${q.o[q.a].en === '4' ? '⬛' : (q.o[q.a].en === 'A triangle' ? '🔺': '❔')}</p>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                ${q.o.map((opt, index) => `
                                    <button class="game-option-btn p-4 rounded-lg text-xl" data-correct="${index === q.a}">
                                        <span class="lang-${currentLanguage}-body">${opt[currentLanguage] || opt}</span>
                                    </button>
                                `).join('')}
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        
                        gameContent.querySelectorAll('.game-option-btn').forEach(btn => {
                            btn.addEventListener('click', e => {
                                showFeedback(e.currentTarget.dataset.correct === 'true', () => this.init());
                            });
                        });
                    }
                },
                variableVoyager: {
                    init() {
                        const num1 = Math.floor(Math.random() * 10) + 1;
                        const result = Math.floor(Math.random() * 10) + num1 + 1; // ensure result is larger
                        const answer = result - num1;

                        gameTitle.textContent = textContent.chapters[9].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                             <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.variableVoyager.instruction[currentLanguage]}</p>
                             <div class="voyager-bg my-6">
                                 🚀 X + ${num1} = ${result}
                             </div>
                             <div class="flex justify-center items-center gap-4">
                                 <p class="text-xl font-bold lang-${currentLanguage}-body">X = </p>
                                <input id="game-answer" type="number" class="p-2 text-2xl text-center w-24 border-2 rounded-lg" />
                                <button id="check-btn" class="px-6 py-3 bg-lime-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        document.getElementById('check-btn').addEventListener('click', () => {
                            const userAnswer = document.getElementById('game-answer').value;
                            showFeedback(parseInt(userAnswer) === answer, () => this.init());
                        });
                    }
                },
                gardenArchitect: {
                     init() {
                        const width = Math.floor(Math.random() * 5) + 4; // 4-8
                        const height = Math.floor(Math.random() * 5) + 4; // 4-8
                        const isPerimeter = Math.random() > 0.5;
                        const answer = isPerimeter ? 2 * (width + height) : width * height;

                        gameTitle.textContent = textContent.chapters[10].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.gardenArchitect.instruction[currentLanguage]}</p>
                            <p class="text-center text-xl font-bold my-4 lang-${currentLanguage}-body">${isPerimeter ? gameData.gardenArchitect.question_perimeter[currentLanguage] : gameData.gardenArchitect.question_area[currentLanguage]}</p>
                             <div class="flex justify-center my-6">
                                 <div class="garden-plot" style="width: ${width*25}px; height: ${height*25}px;">
                                     <span class="dimension-label" style="top: -25px; left: 50%; transform: translateX(-50%);">${width}${gameData.gardenArchitect.unit[currentLanguage]}</span>
                                     <span class="dimension-label" style="left: -40px; top: 50%; transform: translateY(-50%) rotate(-90deg);">${height}${gameData.gardenArchitect.unit[currentLanguage]}</span>
                                 </div>
                             </div>
                            <div class="flex justify-center items-center gap-4">
                                <input id="game-answer" type="number" class="p-2 text-2xl text-center w-32 border-2 rounded-lg" />
                                <span class="text-xl font-bold">${isPerimeter ? gameData.gardenArchitect.unit[currentLanguage] : gameData.gardenArchitect.unit_sq[currentLanguage]}</span>
                            </div>
                             <div class="flex justify-center mt-4">
                                <button id="check-btn" class="px-6 py-3 bg-fuchsia-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;

                         document.getElementById('check-btn').addEventListener('click', () => {
                            const userAnswer = document.getElementById('game-answer').value;
                            showFeedback(parseInt(userAnswer) === answer, () => this.init());
                        });
                    }
                },
                fruitStandFrenzy: {
                    init() {
                        const fruits = [
                            { name: { en: 'Apples', or: 'ସେଓ', hi: 'सेब' }, count: 8, color: '#ef4444' },
                            { name: { en: 'Bananas', or: 'କଦଳୀ', hi: 'केले' }, count: 12, color: '#facc15' },
                            { name: { en: 'Oranges', or: 'କମଳା', hi: 'संतरे' }, count: 10, color: '#f97316' }
                        ];
                        const questionData = gameData.fruitStandFrenzy.questions;
                        const questionIndex = Math.floor(Math.random() * questionData.length);
                        const question = {...questionData[questionIndex]};
                        
                        // Dynamically find correct answer for the 'most sold' question
                        if (question.q.en === 'Which fruit was sold the most?') {
                            let maxCount = -1;
                            let mostSoldIndex = -1;
                            fruits.forEach((fruit, index) => {
                                if (fruit.count > maxCount) {
                                    maxCount = fruit.count;
                                    mostSoldIndex = index;
                                }
                            });
                            question.a = mostSoldIndex;
                        } else if (question.q.en === 'How many fruits were sold in total?') {
                            const totalFruits = fruits.reduce((sum, f) => sum + f.count, 0);
                            question.o = [totalFruits - 5, totalFruits + 5, totalFruits].sort(() => Math.random() - 0.5);
                            question.a = question.o.indexOf(totalFruits);
                        }


                        const chartHeight = 250;
                        const barWidth = 50;
                        const maxCount = Math.max(...fruits.map(f => f.count));

                        gameTitle.textContent = textContent.chapters[11].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.fruitStandFrenzy.instruction[currentLanguage]}</p>
                            <div class="flex justify-center items-end h-[${chartHeight}px] gap-8 border-b-4 border-gray-400 p-4">
                                ${fruits.map(fruit => `
                                    <div class="flex flex-col items-center">
                                        <div style="height: ${(fruit.count / maxCount) * (chartHeight-40)}px; width: ${barWidth}px; background-color: ${fruit.color};" class="rounded-t-lg"></div>
                                        <p class="mt-2 font-bold lang-${currentLanguage}-body">${fruit.name[currentLanguage]}</p>
                                    </div>
                                `).join('')}
                            </div>
                            <p class="text-center text-2xl font-bold my-6 lang-${currentLanguage}-body">"${question.q[currentLanguage]}"</p>
                             <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                 ${question.o.map((opt, index) => `
                                     <button class="game-option-btn p-4 rounded-lg text-xl" data-correct="${index === question.a}">
                                         <span class="lang-${currentLanguage}-body">${typeof opt === 'object' ? opt[currentLanguage] : opt}</span>
                                     </button>
                                 `).join('')}
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                         gameContent.querySelectorAll('.game-option-btn').forEach(btn => {
                            btn.addEventListener('click', e => {
                                showFeedback(e.currentTarget.dataset.correct === 'true', () => this.init());
                            });
                        });
                    }
                },
                blueprintBuilder: {
                    init() {
                        const questionData = gameData.blueprintBuilder.questions;
                        const q = questionData[Math.floor(Math.random() * questionData.length)];
                        
                        gameTitle.textContent = textContent.chapters[12].units[0].title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-xl font-bold my-4 lang-${currentLanguage}-body">${gameData.blueprintBuilder.instruction[currentLanguage]}</p>
                            <p class="text-center text-2xl my-4 p-4 bg-blue-100 border-l-4 border-blue-500 rounded lang-${currentLanguage}-body">"${q.q[currentLanguage]}"</p>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                                ${q.o.map((opt, index) => `
                                    <button class="game-option-btn p-4 rounded-lg text-xl flex flex-col items-center gap-2" data-correct="${index === q.a}">
                                        <span class="tool-icon">${opt.en === 'Ruler' ? '📏' : (opt.en === 'Compass' ? '🧭' : '📐')}</span>
                                        <span class="lang-${currentLanguage}-body">${opt[currentLanguage]}</span>
                                    </button>
                                `).join('')}
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        
                        gameContent.querySelectorAll('.game-option-btn').forEach(btn => {
                            btn.addEventListener('click', e => {
                                showFeedback(e.currentTarget.dataset.correct === 'true', () => this.init());
                            });
                        });
                    }
                },
                comingSoon: {
                    init() {
                        gameTitle.textContent = currentLanguage === 'en' ? 'Coming Soon!' : (currentLanguage === 'or' ? 'ଶୀଘ୍ର ଆସୁଛି' : 'जल्द आ रहा है');
                        gameContent.innerHTML = `<p class="text-center text-2xl p-8 lang-${currentLanguage}-body">${currentLanguage === 'en' ? 'This game is under construction. Check back later!' : (currentLanguage === 'or' ? 'ଏହି ଖେଳ ନିର୍ମାଣାଧୀନ ଅଛି | ପରେ ପୁଣି ଦେଖନ୍ତୁ!' : 'यह गेम निर्माणाधीन है। बाद में फिर से देखें!')}</p>`;
                    }
                }
            };
            
            function showFeedback(isCorrect, nextCallback) {
                const feedbackContainer = document.getElementById('feedback-container');
                if(!feedbackContainer) return;
                
                if (isCorrect) {
                    feedbackContainer.innerHTML = `<p class="text-2xl font-bold text-green-600">${gameData.correct[currentLanguage]}</p>`;
                    setTimeout(() => {
                        if(nextCallback) nextCallback();
                        if(feedbackContainer) feedbackContainer.innerHTML = '';
                    }, 1500);
                } else {
                    feedbackContainer.innerHTML = `<p class="text-2xl font-bold text-red-600">${gameData.tryAgain[currentLanguage]}</p>`;
                     setTimeout(() => {
                         if(feedbackContainer) feedbackContainer.innerHTML = '';
                    }, 1000);
                }
            }
            
            // --- LANGUAGE & NAVIGATION ---
            function updateLanguage() {
                 document.querySelectorAll('[class*="lang-"]').forEach(el => {
                    el.classList.remove('lang-en', 'lang-or', 'lang-hi', 'lang-or-body', 'lang-hi-body');
                    const isTitle = el.tagName === 'H1' || el.tagName === 'H2' || el.classList.contains('play-now-btn') || el.classList.contains('chapter-title') || el.classList.contains('unit-button');
                    
                    if (isTitle) {
                         el.classList.add(`lang-${currentLanguage}`);
                    } else {
                         el.classList.add(currentLanguage === 'or' ? 'lang-or-body' : (currentLanguage === 'hi' ? 'lang-hi-body' : 'lang-en'));
                    }
                });

                platformTitle.textContent = textContent.platformTitle[currentLanguage];
                startScreen.querySelector('h1').textContent = {en: '6th Grade Math', or: 'ଷଷ୍ଠ ଶ୍ରେଣୀ ଗଣିତ', hi: 'कक्षा 6 गणित'}[currentLanguage];
                startScreen.querySelector('p').textContent = {en: 'The Next Level of Adventure!', or: 'ସାହସିକତାର ପରବର୍ତ୍ତୀ ସ୍ତର!', hi: 'साहसिक कार्य का अगला स्तर!'}[currentLanguage];
                playNowBtn.textContent = {en: 'Play Now', or: 'ଏବେ ଖେଳନ୍ତୁ', hi: 'अब खेलें'}[currentLanguage];

                // Re-render views
                const isUnitView = mainContent.querySelector('#back-to-chapters');
                 if (isUnitView) {
                    const h2Element = mainContent.querySelector('h2');
                    let chapterId = null;
                    for (const ch of textContent.chapters) {
                        if(ch.title.en === h2Element.textContent || ch.title.or === h2Element.textContent || ch.title.hi === h2Element.textContent) {
                            chapterId = ch.id;
                            break;
                        }
                    }
                    if(chapterId) {
                       renderUnits(chapterId);
                    } else {
                       renderChapters();
                    }
                } else {
                    renderChapters();
                }
                
                // Update active button style
                [langEnBtn, langOrBtn, langHiBtn].forEach(btn => {
                    btn.classList.remove('bg-emerald-500', 'text-white');
                    btn.classList.add('text-gray-600');
                });
                const activeBtn = document.getElementById(`lang-${currentLanguage}-btn`);
                if (activeBtn) {
                    activeBtn.classList.add('bg-emerald-500', 'text-white');
                    activeBtn.classList.remove('text-gray-600');
                }
            }
            
            // --- EVENT LISTENERS ---
            playNowBtn.addEventListener('click', () => {
                startScreen.style.transition = 'opacity 0.5s ease';
                startScreen.style.opacity = '0';
                setTimeout(() => {
                    startScreen.style.display = 'none';
                    appContainer.style.display = 'block';
                    setTimeout(() => appContainer.style.opacity = '1', 50); // fade in
                }, 500);
            });
            
            langEnBtn.addEventListener('click', () => { if (currentLanguage !== 'en') { currentLanguage = 'en'; updateLanguage(); } });
            langOrBtn.addEventListener('click', () => { if (currentLanguage !== 'or') { currentLanguage = 'or'; updateLanguage(); } });
            langHiBtn.addEventListener('click', () => { if (currentLanguage !== 'hi') { currentLanguage = 'hi'; updateLanguage(); } });

            mainContent.addEventListener('click', (e) => {
                const chapterCard = e.target.closest('.chapter-card');
                if (chapterCard) renderUnits(chapterCard.id);
                if (e.target.closest('#back-to-chapters')) renderChapters();
                
                const unitButton = e.target.closest('.unit-button');
                if (unitButton && unitButton.dataset.game !== 'none') {
                    const gameName = unitButton.dataset.game;
                    if (games[gameName]) {
                        games[gameName].init();
                        gameModal.classList.remove('hidden');
                    }
                }
            });
            
            closeModalBtn.addEventListener('click', () => {
                gameModal.classList.add('hidden');
                gameContent.innerHTML = ''; // Clear content to stop any running intervals if any were added
            });

            // --- INITIALIZATION ---
            createBackground();
            updateLanguage();

        });
    </script>
</body>
</html>

