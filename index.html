<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§ó‡§£‡§ø‡§§ ‡§ï‡§æ ‡§ñ‡•á‡§≤ - 10th Grade Math Adventures</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the gamified platform */
        body {
            font-family: cursive, sans-serif; /* Fun, rounded system font */
            background: linear-gradient(to bottom, #2c3e50, #4ca1af); /* A slightly more mature gradient */
            color: #333;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }
        
        /* Language-specific fonts */
        .lang-en { font-family: cursive, sans-serif; }
        .lang-or, .lang-hi { font-family: sans-serif; font-weight: 700; }
        .lang-or-body, .lang-hi-body { font-family: sans-serif; font-weight: 400; }

        #background-container {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; z-index: -1;
        }

        .start-screen {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; text-align: center;
            background: linear-gradient(to bottom, #2c3e50, #4ca1af);
            color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
            transition: opacity 0.5s ease-out;
        }

        .start-screen h1 { font-size: 4rem; margin-bottom: 1rem; }

        .play-now-btn {
            font-size: 2rem; padding: 1rem 3rem; border-radius: 50px;
            background: #f39c12; color: white; border: 5px solid white; cursor: pointer;
            transition: all 0.3s ease; box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .play-now-btn:hover { transform: scale(1.1); background: #e67e22; }
        
        #app-container { opacity: 0; transition: opacity 1s ease-in-out; }

        .chapter-card {
            background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(8px);
            border: 2px solid rgba(255, 255, 255, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer; text-align: center; padding: 1.5rem; border-radius: 1.5rem;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }
        .chapter-card:hover { transform: translateY(-10px) scale(1.03); box-shadow: 0 15px 30px rgba(0,0,0,0.15); }
        .chapter-title { color: #fff; text-shadow: 1px 1px 3px rgba(0,0,0,0.3); }

        .modal { background: rgba(0, 0, 0, 0.6); }
        .modal-content {
            background: white; border-radius: 1.5rem; border: 5px solid #f1c40f;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* Generic Game Styles */
        .game-option-btn {
            background-color: #f0f0f0; border: 2px solid #ddd;
            transition: all 0.2s ease;
        }
        .game-option-btn:hover {
            transform: scale(1.05); border-color: #f1c40f; background-color: #fffbe6;
        }
        
        /* Animation for floating islands */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }
        .floating-island {
            animation: float 6s ease-in-out infinite;
        }

        /* Equation Balancer */
        .equation-box {
            background-color: #eefbff;
            border-left: 5px solid #3498db;
            font-family: 'Courier New', monospace;
        }

        /* Quadratic Catapult */
        .catapult-game {
            background: #d4e6f1 url('https://www.transparenttextures.com/patterns/light-grass.png');
            border-radius: 1rem;
            position: relative;
            height: 300px;
            border: 2px solid #a9cce3;
        }
        .target {
            position: absolute; bottom: 0;
            font-size: 24px;
            width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            transform: translateX(-50%);
        }
        #catapult-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
        }
        
        .solution-box {
            background-color: #fff5f5;
            border-left: 5px solid #ef4444;
            padding: 1rem;
            margin-top: 1.5rem;
            border-radius: 0.5rem;
        }

    </style>
</head>
<body>

    <div id="background-container"></div>

    <div id="start-screen" class="start-screen">
        <div class="absolute top-8 right-8 flex items-center space-x-2 bg-white/70 backdrop-blur-sm p-2 rounded-full shadow-md z-10">
            <button id="start-lang-en-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">English</button>
            <button id="start-lang-or-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</button>
            <button id="start-lang-hi-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
        </div>
        <h1 class="lang-en">10th Grade Math</h1>
        <p class="text-xl mb-12 lang-en">The Next Level of Adventure!</p>
        <button id="play-now-btn" class="play-now-btn lang-en">Play Now</button>
    </div>

    <!-- Main Application Container -->
    <div id="app-container" class="hidden min-h-screen p-4 sm:p-6 lg:p-8">
        <header class="flex justify-between items-center mb-8">
            <h1 id="platform-title" class="text-3xl md:text-4xl font-bold text-white text-shadow"></h1>
            <div class="flex items-center space-x-2 bg-white/70 backdrop-blur-sm p-2 rounded-full shadow-md">
                <button id="lang-en-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">English</button>
                <button id="lang-or-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</button>
                <button id="lang-hi-btn" class="px-4 py-2 rounded-full text-sm font-semibold text-gray-600">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
            </div>
        </header>
        <main id="main-content"></main>
    </div>

    <!-- Game Modal -->
    <div id="game-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 modal">
        <div class="modal-content w-full max-w-4xl max-h-[90vh] rounded-2xl shadow-2xl p-6 relative flex flex-col">
            <div class="flex justify-between items-center pb-4 border-b border-gray-200">
                <h2 id="game-title" class="text-3xl font-bold text-emerald-700">Game Title</h2>
                <button id="close-modal-btn" class="text-gray-500 hover:text-red-600 transition-colors">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="game-content" class="flex-grow mt-4 overflow-y-auto"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            function createBackground() {
                const bgContainer = document.getElementById('background-container');
                const svgNS = "http://www.w3.org/2000/svg";
                const svg = document.createElementNS(svgNS, "svg");
                svg.setAttribute('width', '100%');
                svg.setAttribute('height', '100%');
                svg.setAttribute('preserveAspectRatio', 'xMidYMid slice');
                // Clouds
                for (let i = 0; i < 15; i++) {
                    const circle = document.createElementNS(svgNS, "circle");
                    circle.setAttribute('cx', `${Math.random() * 100}%`);
                    circle.setAttribute('cy', `${Math.random() * 40}%`);
                    circle.setAttribute('r', `${Math.random() * 50 + 20}`);
                    circle.setAttribute('fill', 'rgba(255, 255, 255, 0.2)');
                    circle.style.filter = 'blur(15px)';
                    svg.appendChild(circle);
                }
                // Floating Islands - NOW ANIMATED!
                const islandColors = ['#8B4513', '#A0522D', '#D2691E'];
                for (let i = 0; i < 5; i++) {
                    const path = document.createElementNS(svgNS, "path");
                    const x = Math.random() * 80 + 10;
                    const y = Math.random() * 60 + 20;
                    const d = `M ${x-5} ${y} C ${x-10} ${y+10}, ${x+10} ${y+10}, ${x+5} ${y} Z`;
                    path.setAttribute('d', d);
                    path.setAttribute('fill', islandColors[i % 3]);
                    path.style.filter = 'drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4))';
                    path.classList.add('floating-island'); // Add class for animation
                    path.style.animationDelay = `${i * 1.2}s`; // Stagger animations
                    svg.appendChild(path);
                }
                bgContainer.appendChild(svg);
            }

            let currentLanguage = 'hi'; // Default to Hindi
            const textContent = {
                platformTitle: { en: '10th Grade Math', or: '‡¨¶‡¨∂‡¨Æ ‡¨∂‡≠ç‡¨∞‡≠á‡¨£‡≠Ä ‡¨ó‡¨£‡¨ø‡¨§', hi: '‡¨ï‡¨ï‡≠ç‡¨∑‡¨æ 10 ‡¨ó‡¨£‡¨ø‡¨§' },
                chapters: [
                    // Algebra
                    { id: 'alg1', title: { en: 'Linear Simultaneous Equations', or: '‡¨∏‡¨∞‡¨≥ ‡¨∏‡¨π‡¨∏‡¨Æ‡≠Ä‡¨ï‡¨∞‡¨£', hi: '‡§∞‡•à‡§ñ‡§ø‡§ï ‡§Ø‡•Å‡§ó‡§™‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£' }, color: 'bg-blue-500', units: [{ id: 'u_alg1', game: 'equationBalancer' }] },
                    { id: 'alg2', title: { en: 'Quadratic Equation', or: '‡¨¶‡≠ç‡¨¨‡¨ø‡¨ò‡¨æ‡¨§ ‡¨∏‡¨Æ‡≠Ä‡¨ï‡¨∞‡¨£', hi: '‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£' }, color: 'bg-green-500', units: [{ id: 'u_alg2', game: 'quadraticCatapult' }] },
                    { id: 'alg3', title: { en: 'Arithmetic Progression', or: '‡¨∏‡¨Æ‡¨æ‡¨®‡≠ç‡¨§‡¨∞ ‡¨™‡≠ç‡¨∞‡¨ó‡¨§‡¨ø', hi: '‡§∏‡§Æ‡§æ‡§Ç‡§§‡§∞ ‡§∂‡•ç‡§∞‡•á‡§¢‡§º‡•Ä' }, color: 'bg-yellow-500', units: [{ id: 'u_alg3', game: 'progressionPath' }] },
                    { id: 'alg4', title: { en: 'Probability', or: '‡¨∏‡¨Æ‡≠ç‡¨≠‡¨æ‡¨¨‡≠ç‡≠ü‡¨§‡¨æ', hi: '‡§™‡•ç‡§∞‡§æ‡§Ø‡§ø‡§ï‡§§‡§æ' }, color: 'bg-purple-500', units: [{ id: 'u_alg4', game: 'probabilitySpinner' }] },
                    { id: 'alg5', title: { en: 'Statistics', or: '‡¨™‡¨∞‡¨ø‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡¨®', hi: '‡§∏‡§æ‡§Ç‡§ñ‡•ç‡§Ø‡§ø‡§ï‡•Ä' }, color: 'bg-pink-500', units: [{ id: 'u_alg5', game: 'dataDetective' }] },
                    { id: 'alg6', title: { en: 'Coordinate Geometry', or: '‡¨∏‡≠ç‡¨•‡¨æ‡¨®‡¨æ‡¨ô‡≠ç‡¨ï ‡¨ú‡≠ç‡≠ü‡¨æ‡¨Æ‡¨ø‡¨§‡¨ø', hi: '‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§æ‡§Ç‡§ï ‡§ú‡•ç‡§Ø‡§æ‡§Æ‡§ø‡§§‡§ø' }, color: 'bg-indigo-500', units: [{ id: 'u_alg6', game: 'distanceDash' }] },
                    { id: 'alg7', title: { en: 'Road Safety Education', or: '‡¨∏‡¨°‡¨º‡¨ï ‡¨∏‡≠Å‡¨∞‡¨ï‡≠ç‡¨∑‡¨æ ‡¨∂‡¨ø‡¨ï‡≠ç‡¨∑‡¨æ', hi: '‡§∏‡§°‡§º‡§ï ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ' }, color: 'bg-red-500', units: [{ id: 'u_alg7', game: 'safeStopChallenge' }] },
                    // Geometry
                    { id: 'geo1', title: { en: 'Similarity', or: '‡¨ú‡≠ç‡≠ü‡¨æ‡¨Æ‡¨ø‡¨§‡¨ø‡¨∞‡≠á ‡¨∏‡¨æ‡¨¶‡≠É‡¨∂‡≠ç‡≠ü', hi: '‡§∏‡§Æ‡§∞‡•Ç‡§™‡§§‡§æ' }, color: 'bg-orange-500', units: [{ id: 'u_geo1', game: 'scaleFactorSurveyor' }] },
                    { id: 'geo2', title: { en: 'Circle', or: '‡¨¨‡≠É‡¨§‡≠ç‡¨§', hi: '‡§µ‡•É‡§§‡•ç‡§§' }, color: 'bg-cyan-500', units: [{ id: 'u_geo2', game: 'arcAngleArcher' }] },
                    { id: 'geo3', title: { en: 'Tangent to a Circle', or: '‡¨¨‡≠É‡¨§‡≠ç‡¨§‡¨∞ ‡¨∏‡≠ç‡¨™‡¨∞‡≠ç‡¨∂‡¨ï', hi: '‡§µ‡•É‡§§‡•ç‡§§ ‡§ï‡•Ä ‡§∏‡•ç‡§™‡§∞‡•ç‡§∂ ‡§∞‡•á‡§ñ‡§æ' }, color: 'bg-lime-500', units: [{ id: 'u_geo3', game: 'tangentTracer' }] },
                    { id: 'geo4', title: { en: 'Trigonometry', or: '‡¨§‡≠ç‡¨∞‡¨ø‡¨ï‡≠ã‡¨£‡¨Æ‡¨ø‡¨§‡¨ø', hi: '‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£‡§Æ‡§ø‡§§‡§ø' }, color: 'bg-fuchsia-500', units: [{ id: 'u_geo4', game: 'trigTower' }] },
                    { id: 'geo5', title: { en: 'Mensuration', or: '‡¨™‡¨∞‡¨ø‡¨Æ‡¨ø‡¨§‡¨ø', hi: '‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§Æ‡§ø‡§§‡§ø' }, color: 'bg-rose-500', units: [{ id: 'u_geo5', game: 'volumeVoyage' }] },
                    { id: 'geo6', title: { en: 'Constructions', or: '‡¨Ö‡¨ô‡≠ç‡¨ï‡¨®', hi: '‡§∞‡§ö‡§®‡§æ‡§è‡§Å' }, color: 'bg-sky-500', units: [{ id: 'u_geo6', game: 'constructionCrew' }] }
                ]
            };
            
            const gameData = {
                checkAnswer: { en: 'Check', or: '‡¨Ø‡¨æ‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å', hi: '‡§ú‡§æ‡§Å‡§ö ‡§ï‡§∞‡•á‡§Ç' },
                correct: { en: 'Correct!', or: '‡¨†‡¨ø‡¨ï‡≠ç ‡¨Ö‡¨õ‡¨ø!', hi: '‡§∏‡§π‡•Ä ‡§π‡•à!' },
                tryAgain: { en: 'Incorrect. Let\'s review!', or: '‡¨≠‡≠Å‡¨≤ ‡¨Ö‡¨õ‡¨ø‡•§ ‡¨Ü‡¨∏‡¨®‡≠ç‡¨§‡≠Å ‡¨¶‡≠á‡¨ñ‡¨ø‡¨¨‡¨æ!', hi: '‡§ó‡§≤‡§§‡•§ ‡§Ü‡§á‡§è ‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç!' },
                next: { en: 'Next', or: '‡¨™‡¨∞‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡≠Ä', hi: '‡§Ö‡§ó‡§≤‡§æ' },
                hit: { en: 'Hit!', or: '‡¨π‡¨ø‡¨ü‡≠ç!', hi: '‡§®‡§ø‡§∂‡§æ‡§®‡§æ ‡§≤‡§ó‡§æ!' },
                solutionTitle: { en: 'Here\'s the method:', or: '‡¨è‡¨†‡¨æ‡¨∞‡≠á ‡¨™‡≠ç‡¨∞‡¨£‡¨æ‡¨≥‡≠Ä ‡¨¶‡¨ø‡¨Ü‡¨ó‡¨≤‡¨æ:', hi: '‡§Ø‡§π‡§æ‡§Å ‡§µ‡§ø‡§ß‡§ø ‡§π‡•à:' },
                correctAnswerIs: { en: 'The correct answer is', or: '‡¨∏‡¨†‡¨ø‡¨ï‡≠ç ‡¨â‡¨§‡≠ç‡¨§‡¨∞ ‡¨π‡≠á‡¨â‡¨õ‡¨ø', hi: '‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞ ‡§π‡•à' },
                nextQuestion: { en: 'Next Question', or: '‡¨™‡¨∞‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡≠Ä ‡¨™‡≠ç‡¨∞‡¨∂‡≠ç‡¨®', hi: '‡§Ö‡§ó‡§≤‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®' },
                equationBalancer: { 
                    instruction: { en: 'Find the values of X and Y to balance the equations!', or: '‡¨∏‡¨Æ‡≠Ä‡¨ï‡¨∞‡¨£‡¨ï‡≠Å ‡¨∏‡¨®‡≠ç‡¨§‡≠Å‡¨≥‡¨ø‡¨§ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å X ‡¨è‡¨¨‡¨Ç Y‡¨∞ ‡¨Æ‡≠Ç‡¨≤‡≠ç‡≠ü ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å!', hi: '‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Ç‡§§‡•Å‡§≤‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è X ‡§î‡§∞ Y ‡§ï‡§æ ‡§Æ‡§æ‡§® ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è!' },
                    xEquals: { en: 'x =', or: 'x =', hi: 'x =' },
                    yEquals: { en: 'y =', or: 'y =', hi: 'y =' }
                },
                quadraticCatapult: { 
                    instruction: { en: 'Find a root of the equation to launch the catapult and hit a target!', or: '‡¨ï‡≠á‡¨ü‡¨æ‡¨™‡¨≤‡≠ç‡¨ü ‡¨≤‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨è‡¨¨‡¨Ç ‡¨≤‡¨ï‡≠ç‡¨∑‡≠ç‡≠ü‡¨ï‡≠Å ‡¨Æ‡¨æ‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨∏‡¨Æ‡≠Ä‡¨ï‡¨∞‡¨£‡¨∞ ‡¨è‡¨ï ‡¨Æ‡≠Ç‡¨≥ ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å!', hi: '‡§ó‡•Å‡§≤‡•á‡§≤ ‡§≤‡•â‡§®‡•ç‡§ö ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§ï‡•ã ‡§≠‡•á‡§¶‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ ‡§ï‡§æ ‡§è‡§ï ‡§Æ‡•Ç‡§≤ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è!' }, 
                    launch: { en: 'Launch!', or: '‡¨≤‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å!', hi: '‡§≤‡§æ‡§Ç‡§ö!' },
                    rootLabel: { en: 'Root =', or: '‡¨Æ‡≠Ç‡¨≥ =', hi: '‡§Æ‡•Ç‡§≤ =' }
                },
                progressionPath: { instruction: { en: 'Find the next number in the Arithmetic Progression to help the frog cross!', or: '‡¨è‡¨∞‡¨ø‡¨•‡¨Æ‡≠á‡¨ü‡¨ø‡¨ï‡≠ç ‡¨™‡≠ç‡¨∞‡≠ã‡¨ó‡≠ç‡¨∞‡≠á‡¨∏‡¨®‡¨∞‡≠á ‡¨™‡¨∞‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡≠Ä ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ ‡¨ñ‡≠ã‡¨ú‡¨ø ‡¨¨‡≠á‡¨ô‡≠ç‡¨ó‡¨ï‡≠Å ‡¨™‡¨æ‡¨∞‡¨ø ‡¨π‡≠á‡¨¨‡¨æ‡¨∞‡≠á ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å!', hi: '‡§Æ‡•á‡§Ç‡§¢‡§ï ‡§ï‡•ã ‡§™‡§æ‡§∞ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Æ‡§æ‡§Ç‡§§‡§∞ ‡§∂‡•ç‡§∞‡•á‡§¢‡§º‡•Ä ‡§Æ‡•á‡§Ç ‡§Ö‡§ó‡§≤‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è!' } },
                probabilitySpinner: { 
                    instruction: { en: 'Find the probability of landing on Red. Simplify your fraction.', or: '‡¨≤‡¨æ‡¨≤‡≠ç ‡¨â‡¨™‡¨∞‡≠á ‡¨Ö‡¨¨‡¨§‡¨∞‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡¨∞ ‡¨∏‡¨Æ‡≠ç‡¨≠‡¨æ‡¨¨‡¨®‡¨æ ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å | ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨≠‡¨ó‡≠ç‡¨®‡¨æ‡¨Ç‡¨∂‡¨ï‡≠Å ‡¨∏‡¨∞‡¨≥ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å |', hi: '‡§≤‡§æ‡§≤ ‡§™‡§∞ ‡§Ü‡§®‡•á ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§æ‡§Ø‡§ø‡§ï‡§§‡§æ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è‡•§ ‡§Ö‡§™‡§®‡•á ‡§≠‡§ø‡§®‡•ç‡§® ‡§ï‡•ã ‡§∏‡§∞‡§≤ ‡§ï‡•Ä‡§ú‡§ø‡§è‡•§' }, 
                    numerator: { en: 'Numerator', or: '‡¨≤‡¨¨', hi: '‡§Ö‡§Ç‡§∂' }, 
                    denominator: { en: 'Denominator', or: '‡¨π‡¨∞', hi: '‡§π‡§∞' } 
                },
                dataDetective: { 
                    instruction: { en: 'Be a Data Detective! Find the Median of this dataset.', or: '‡¨è‡¨ï ‡¨°‡¨æ‡¨ü‡¨æ ‡¨°‡¨ø‡¨ü‡≠á‡¨ï‡≠ç‡¨ü‡¨ø‡¨≠‡≠ç ‡¨π‡≠Å‡¨Ö‡¨®‡≠ç‡¨§‡≠Å! ‡¨è‡¨π‡¨ø ‡¨°‡¨æ‡¨ü‡¨æ‡¨∏‡≠á‡¨ü‡¨∞ ‡¨Æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨æ ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§è‡§ï ‡§°‡•á‡§ü‡§æ ‡§ú‡§æ‡§∏‡•Ç‡§∏ ‡§¨‡§®‡•á‡§Ç! ‡§á‡§∏ ‡§°‡•á‡§ü‡§æ‡§∏‡•á‡§ü ‡§ï‡§æ ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§ø‡§ï‡§æ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è‡•§' },
                    placeholder: { en: 'Median?', or: '‡¨Æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨æ?', hi: '‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§ø‡§ï‡§æ?' }
                },
                distanceDash: { 
                    instruction: { en: 'Calculate the distance between the two points.', or: '‡¨¶‡≠Å‡¨á‡¨ü‡¨ø ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å ‡¨Æ‡¨ß‡≠ç‡≠ü‡¨∞‡≠á ‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ ‡¨ó‡¨£‡¨®‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§¶‡•ã ‡§¨‡§ø‡§Ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§ï‡•Ä ‡§¶‡•Ç‡§∞‡•Ä ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§' },
                    pointA: { en: 'Point A:', or: '‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å A:', hi: '‡§¨‡§ø‡§Ç‡§¶‡•Å A:' },
                    pointB: { en: 'Point B:', or: '‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å B:', hi: '‡§¨‡§ø‡§Ç‡§¶‡•Å B:' },
                    placeholder: { en: 'Distance?', or: '‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ?', hi: '‡§¶‡•Ç‡§∞‡•Ä?' }
                },
                safeStopChallenge: { 
                    instruction: { en: 'A car is moving at the speed shown. Calculate the total stopping distance in meters. (Round to nearest whole number)', or: '‡¨è‡¨ï ‡¨ï‡¨æ‡¨∞‡≠ç ‡¨¶‡≠á‡¨ñ‡¨æ‡¨Ø‡¨æ‡¨á‡¨•‡¨ø‡¨¨‡¨æ ‡¨ó‡¨§‡¨ø‡¨∞‡≠á ‡¨Ø‡¨æ‡¨â‡¨õ‡¨ø‡•§ ‡¨Æ‡¨ø‡¨ü‡¨∞‡¨∞‡≠á ‡¨Æ‡≠ã‡¨ü ‡¨Ö‡¨ü‡¨ï‡¨ø‡¨¨‡¨æ ‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ ‡¨ó‡¨£‡¨®‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§ (‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ ‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡¨ï‡≠Å ‡¨∞‡¨æ‡¨â‡¨£‡≠ç‡¨° ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å)', hi: '‡§è‡§ï ‡§ï‡§æ‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§ó‡§à ‡§ó‡§§‡§ø ‡§∏‡•á ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ ‡§Æ‡•Ä‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§≤ ‡§∞‡•Å‡§ï‡§®‡•á ‡§ï‡•Ä ‡§¶‡•Ç‡§∞‡•Ä ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§ (‡§®‡§ø‡§ï‡§ü‡§§‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç)' },
                    kmh: { en: 'km/h', or: '‡¨ï‡¨ø‡¨Æ‡¨ø/‡¨ò‡¨£‡≠ç‡¨ü‡¨æ', hi: '‡§ï‡§ø‡§Æ‡•Ä/‡§ò‡§Ç‡§ü‡§æ' },
                    placeholder: { en: 'Distance (m)?', or: '‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ (m)?', hi: '‡§¶‡•Ç‡§∞‡•Ä (m)?' }
                },
                scaleFactorSurveyor: { 
                    instruction: { en: 'Help the surveyor find the length of side X using similar triangles.', or: '‡¨∏‡¨∞‡≠ç‡¨¨‡≠á‡¨ï‡≠ç‡¨∑‡¨ï‡¨ô‡≠ç‡¨ï‡≠Å ‡¨∏‡¨Æ‡¨æ‡¨® ‡¨§‡≠ç‡¨∞‡¨ø‡¨≠‡≠Å‡¨ú ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨ø X ‡¨™‡¨æ‡¨∞‡≠ç‡¨∂‡≠ç‡¨µ‡¨∞ ‡¨¶‡≠à‡¨∞‡≠ç‡¨ò‡≠ç‡≠ü ‡¨ñ‡≠ã‡¨ú‡¨ø‡¨¨‡¨æ‡¨∞‡≠á ‡¨∏‡¨æ‡¨π‡¨æ‡¨Ø‡≠ç‡≠ü ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§∏‡§Æ‡§∞‡•Ç‡§™ ‡§§‡•ç‡§∞‡§ø‡§≠‡•Å‡§ú‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§≠‡•Å‡§ú‡§æ X ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§∞‡•ç‡§µ‡•á‡§ï‡•ç‡§∑‡§ï ‡§ï‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§' },
                    placeholder: { en: 'Length of X?', or: 'X ‡¨∞ ‡¨¶‡≠à‡¨∞‡≠ç‡¨ò‡≠ç‡≠ü?', hi: 'X ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à?' }
                },
                arcAngleArcher: { 
                    instruction: { en: 'An archer hits a target. Given the radius and arc length, find the central angle Œ∏. (Use œÄ ‚âà 3.14 and round to nearest degree)', or: '‡¨ú‡¨£‡≠á ‡¨ß‡¨®‡≠Å‡¨∞‡≠ç‡¨¶‡≠ç‡¨ß‡¨∞ ‡¨è‡¨ï ‡¨≤‡¨ï‡≠ç‡¨∑‡≠ç‡≠ü‡¨ï‡≠Å ‡¨Æ‡¨æ‡¨∞‡¨®‡≠ç‡¨§‡¨ø‡•§ ‡¨¨‡≠ç‡≠ü‡¨æ‡¨∏‡¨æ‡¨∞‡≠ç‡¨¶‡≠ç‡¨ß ‡¨è‡¨¨‡¨Ç ‡¨ö‡¨æ‡¨™ ‡¨¶‡≠à‡¨∞‡≠ç‡¨ò‡≠ç‡≠ü ‡¨¶‡¨ø‡¨Ü‡¨Ø‡¨æ‡¨á, ‡¨ï‡≠á‡¨®‡≠ç‡¨¶‡≠ç‡¨∞‡≠Ä‡≠ü ‡¨ï‡≠ã‡¨£ Œ∏ ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å‡•§ (œÄ ‚âà 3.14 ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨è‡¨¨‡¨Ç ‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ ‡¨°‡¨ø‡¨ó‡≠ç‡¨∞‡≠Ä‡¨ï‡≠Å ‡¨∞‡¨æ‡¨â‡¨£‡≠ç‡¨° ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å)', hi: '‡§è‡§ï ‡§§‡•Ä‡§∞‡§Ç‡§¶‡§æ‡§ú ‡§è‡§ï ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§ï‡•ã ‡§≠‡•á‡§¶‡§§‡§æ ‡§π‡•à‡•§ ‡§§‡•ç‡§∞‡§ø‡§ú‡•ç‡§Ø‡§æ ‡§î‡§∞ ‡§ö‡§æ‡§™ ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§ï‡•ã ‡§¶‡•á‡§ñ‡§§‡•á ‡§π‡•Å‡§è, ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡•Ä‡§Ø ‡§ï‡•ã‡§£ Œ∏ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è‡•§ (œÄ ‚âà 3.14 ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§®‡§ø‡§ï‡§ü‡§§‡§Æ ‡§°‡§ø‡§ó‡•ç‡§∞‡•Ä ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç)' },
                    placeholder: { en: 'Angle Œ∏?', or: '‡¨ï‡≠ã‡¨£ Œ∏?', hi: '‡§ï‡•ã‡§£ Œ∏?' }
                },
                tangentTracer: { 
                    instruction: { en: 'Find the length of the tangent (t) from the point to the circle.', or: '‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å‡¨∞‡≠Å ‡¨¨‡≠É‡¨§‡≠ç‡¨§ ‡¨™‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü‡¨®‡≠ç‡¨§ ‡¨∏‡≠ç‡¨™‡¨∞‡≠ç‡¨∂‡¨ï (t)‡¨∞ ‡¨¶‡≠à‡¨∞‡≠ç‡¨ò‡≠ç‡≠ü ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§¨‡§ø‡§Ç‡§¶‡•Å ‡§∏‡•á ‡§µ‡•É‡§§‡•ç‡§§ ‡§§‡§ï ‡§∏‡•ç‡§™‡§∞‡•ç‡§∂ ‡§∞‡•á‡§ñ‡§æ (t) ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è‡•§' },
                    placeholder: { en: 'Length of t?', or: 't ‡¨∞ ‡¨¶‡≠à‡¨∞‡≠ç‡¨ò‡≠ç‡≠ü?', hi: 't ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à?' }
                },
                trigTower: { 
                    instruction: { en: 'Find the height (h) of the tower. (Round to the nearest whole number)', or: '‡¨ü‡¨æ‡≠±‡¨æ‡¨∞‡¨∞ ‡¨â‡¨ö‡≠ç‡¨ö‡¨§‡¨æ (h) ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å‡•§ (‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ ‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡¨ï‡≠Å ‡¨∞‡¨æ‡¨â‡¨£‡≠ç‡¨° ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å)', hi: '‡§ü‡•â‡§µ‡§∞ ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à (h) ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è‡•§ (‡§®‡§ø‡§ï‡§ü‡§§‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç)' },
                    placeholder: { en: 'Height (h)?', or: '‡¨â‡¨ö‡≠ç‡¨ö‡¨§‡¨æ (h)?', hi: '‡§ä‡§Å‡§ö‡§æ‡§à (h)?' }
                },
                volumeVoyage: { 
                    instruction: { en: 'Find the volume of the cylinder. (Use œÄ ‚âà 3.14 and round to the nearest whole number)', or: '‡¨∏‡¨ø‡¨≤‡¨ø‡¨£‡≠ç‡¨°‡¨∞‡¨∞ ‡¨Ü‡≠ü‡¨§‡¨® ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å‡•§ (œÄ ‚âà 3.14 ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨è‡¨¨‡¨Ç ‡¨®‡¨ø‡¨ï‡¨ü‡¨§‡¨Æ ‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡¨ï‡≠Å ‡¨∞‡¨æ‡¨â‡¨£‡≠ç‡¨° ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å)', hi: '‡§∏‡§ø‡§≤‡•á‡§Ç‡§°‡§∞ ‡§ï‡§æ ‡§Ü‡§Ø‡§§‡§® ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è‡•§ (œÄ ‚âà 3.14 ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§®‡§ø‡§ï‡§ü‡§§‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§§‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç)' },
                    placeholder: { en: 'Volume?', or: '‡¨Ü‡≠ü‡¨§‡¨®?', hi: '‡§Ü‡§Ø‡§§‡§®?' }
                },
                constructionCrew: { instruction: { en: 'You are bisecting an angle. What is the correct next step?', or: '‡¨Ü‡¨™‡¨£ ‡¨è‡¨ï ‡¨ï‡≠ã‡¨£‡¨ï‡≠Å ‡¨¶‡≠ç‡≠±‡¨ø‡¨ñ‡¨£‡≠ç‡¨°‡¨ø‡¨§ ‡¨ï‡¨∞‡≠Å‡¨õ‡¨®‡≠ç‡¨§‡¨ø‡•§ ‡¨™‡¨∞‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡≠Ä ‡¨∏‡¨†‡¨ø‡¨ï‡≠ç ‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡¨ï‚Äô‡¨£?', hi: '‡§Ü‡§™ ‡§è‡§ï ‡§ï‡•ã‡§£ ‡§ï‡§æ ‡§∏‡§Æ‡§¶‡•ç‡§µ‡§ø‡§≠‡§æ‡§ú‡§® ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ö‡§ó‡§≤‡§æ ‡§∏‡§π‡•Ä ‡§ï‡§¶‡§Æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?' } }
            };

            const mainContent = document.getElementById('main-content');
            const gameModal = document.getElementById('game-modal');
            const gameTitle = document.getElementById('game-title');
            const gameContent = document.getElementById('game-content');
            let activeGame = null;

            function renderChapters() {
                mainContent.innerHTML = `
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6 md:gap-8 overflow-y-auto h-[calc(100vh-120px)] pb-12 pr-4">
                        ${textContent.chapters.map(chapter => {
                            const unit = chapter.units[0];
                            return `
                            <div data-game="${unit.game}" data-chapter-id="${chapter.id}" class="chapter-card ${chapter.color}">
                                <div class="text-white">
                                    <h2 class="text-xl lg:text-2xl font-bold mb-2 chapter-title lang-${currentLanguage}">${chapter.title[currentLanguage]}</h2>
                                </div>
                            </div>
                            `}).join('')}
                    </div>
                `;
            }

             const games = {
                equationBalancer: {
                    currentQuestion: null,
                    generateData() { const x = Math.floor(Math.random() * 8) + 1; const y = Math.floor(Math.random() * 8) + 1; const a = 2; const b = 1; this.currentQuestion = { eq1: `${a}x + ${b}y = ${a * x + b * y}`, eq2: `x + y = ${x + y}`, solution: { x, y } }; return this.currentQuestion; },
                    getSolutionExplanation() { const { solution } = this.currentQuestion; return { en: `Use substitution. From <b>y = ${solution.x + solution.y} - x</b>, substitute into the first equation: <b>2x + (${solution.x + solution.y} - x) = ${2*solution.x + solution.y}</b>. This gives <b>x = ${solution.x}</b>. Then find y.`, or: `‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨∏‡≠ç‡¨•‡¨æ‡¨™‡¨® ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§ <b>y = ${solution.x + solution.y} - x</b> ‡¨∞‡≠Å, ‡¨™‡≠ç‡¨∞‡¨•‡¨Æ ‡¨∏‡¨Æ‡≠Ä‡¨ï‡¨∞‡¨£‡¨∞‡≠á ‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨∏‡≠ç‡¨•‡¨æ‡¨™‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å: <b>2x + (${solution.x + solution.y} - x) = ${2*solution.x + solution.y}</b>‡•§ ‡¨è‡¨π‡¨æ <b>x = ${solution.x}</b> ‡¨¶‡¨ø‡¨è‡•§ ‡¨§‡¨æ'‡¨™‡¨∞‡≠á y ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å‡•§`, hi: `‡§™‡•ç‡§∞‡§§‡§ø‡§∏‡•ç‡§•‡§æ‡§™‡§® ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§ <b>y = ${solution.x + solution.y} - x</b> ‡§∏‡•á, ‡§™‡§π‡§≤‡•á ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§§‡§ø‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç: <b>2x + (${solution.x + solution.y} - x) = ${2*solution.x + solution.y}</b>‡•§ ‡§á‡§∏‡§∏‡•á <b>x = ${solution.x}</b> ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à‡•§ ‡§´‡§ø‡§∞ y ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§`, answer: `x=${solution.x}, y=${solution.y}` }; },
                    init(chapterId) {
                        activeGame = this;
                        const question = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.equationBalancer.instruction[currentLanguage]}</p>
                            <div class="space-y-4 my-6">
                               <div class="equation-box p-4 rounded-lg text-2xl text-center">${question.eq1}</div>
                               <div class="equation-box p-4 rounded-lg text-2xl text-center">${question.eq2}</div>
                            </div>
                            <div class="flex justify-center items-center gap-4">
                                <span class="text-xl font-bold">${gameData.equationBalancer.xEquals[currentLanguage]}</span><input id="x-answer" type="number" class="p-2 text-xl text-center w-20 border-2 rounded-lg" />
                                <span class="text-xl font-bold">${gameData.equationBalancer.yEquals[currentLanguage]}</span><input id="y-answer" type="number" class="p-2 text-xl text-center w-20 border-2 rounded-lg" />
                                <button id="check-btn" class="px-6 py-3 bg-blue-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        document.getElementById('check-btn').addEventListener('click', () => {
                            const x = document.getElementById('x-answer').value;
                            const y = document.getElementById('y-answer').value;
                            showFeedback(parseInt(x) === this.currentQuestion.solution.x && parseInt(y) === this.currentQuestion.solution.y, () => this.init(chapterId));
                        });
                    }
                },
                quadraticCatapult: {
                    currentQuestion: null,
                    generateData() { const r1 = Math.floor(Math.random() * 4) + 1; const r2 = Math.floor(Math.random() * 5) + 5; this.currentQuestion = { equation: `x¬≤ - ${r1 + r2}x + ${r1 * r2} = 0`, roots: [r1, r2], sum: r1 + r2, product: r1 * r2, }; return this.currentQuestion; },
                    getSolutionExplanation() { const { sum, product, roots } = this.currentQuestion; return { en: `Factor the equation. Find two numbers that add to <b>${sum}</b> and multiply to <b>${product}</b>. The numbers are ${roots[0]} and ${roots[1]}. So, <b>(x - ${roots[0]})(x - ${roots[1]}) = 0</b>.`, or: `‡¨∏‡¨Æ‡≠Ä‡¨ï‡¨∞‡¨£‡¨ï‡≠Å ‡¨´‡≠ç‡≠ü‡¨æ‡¨ï‡≠ç‡¨ü‡¨∞‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§ ‡¨¶‡≠Å‡¨á‡¨ü‡¨ø ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å ‡¨Ø‡¨æ‡¨π‡¨æ‡¨∞ ‡¨Ø‡≠ã‡¨ó‡¨´‡¨≥ <b>${sum}</b> ‡¨è‡¨¨‡¨Ç ‡¨ó‡≠Å‡¨£‡¨´‡¨≥ <b>${product}</b>‡•§ ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï ‡¨π‡≠á‡¨â‡¨õ‡¨ø ${roots[0]} ‡¨è‡¨¨‡¨Ç ${roots[1]}‡•§ ‡¨§‡≠á‡¨£‡≠Å, <b>(x - ${roots[0]})(x - ${roots[1]}) = 0</b>‡•§`, hi: `‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ ‡§ï‡§æ ‡§ó‡•Å‡§£‡§®‡§ñ‡§Ç‡§° ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§ê‡§∏‡•Ä ‡§¶‡•ã ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ‡§è‡§Å ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ú‡§ø‡§®‡§ï‡§æ ‡§Ø‡•ã‡§ó <b>${sum}</b> ‡§π‡•ã ‡§î‡§∞ ‡§ó‡•Å‡§£‡§®‡§´‡§≤ <b>${product}</b> ‡§π‡•ã‡•§ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ‡§è‡§Å ${roots[0]} ‡§î‡§∞ ${roots[1]} ‡§π‡•à‡§Ç‡•§ ‡§§‡•ã, <b>(x - ${roots[0]})(x - ${roots[1]}) = 0</b>‡•§`, answer: `${roots[0]} or ${roots[1]}` }; },
                    animateProjectile(hitRoot) { const canvas = document.getElementById('catapult-canvas'); if (!canvas) return; const ctx = canvas.getContext('2d'); const w = canvas.width, h = canvas.height; ctx.clearRect(0, 0, w, h); const startX = 20, startY = h - 20; const targetX = (hitRoot / 10) * w; const controlY = -h/2; let progress = 0; const animation = () => { progress += 0.02; if (progress > 1) { showFeedback(true, () => this.init(gameTitle.dataset.chapterId), gameData.hit[currentLanguage]); return; } const x = startX + (targetX - startX) * progress; const y = startY + 4 * (startY - controlY) * (progress - progress * progress); ctx.clearRect(0, 0, w, h); ctx.beginPath(); ctx.arc(x, y, 8, 0, Math.PI * 2); ctx.fillStyle = '#34495e'; ctx.fill(); requestAnimationFrame(animation); }; animation(); },
                    init(chapterId) {
                        activeGame = this;
                        const question = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.quadraticCatapult.instruction[currentLanguage]}</p>
                             <div class="equation-box p-4 rounded-lg text-2xl text-center font-bold my-4">${question.equation}</div>
                            <div class="catapult-game p-4">
                                <canvas id="catapult-canvas" width="600" height="300"></canvas>
                                <div class="target" style="left: ${question.roots[0] * 10}%;">üéØ</div>
                                <div class="target" style="left: ${question.roots[1] * 10}%;">üéØ</div>
                            </div>
                             <div class="flex justify-center items-center gap-4 mt-4">
                                <span class="text-xl font-bold">${gameData.quadraticCatapult.rootLabel[currentLanguage]}</span><input id="game-answer" type="number" class="p-2 text-xl text-center w-24 border-2 rounded-lg" />
                                <button id="check-btn" class="px-6 py-3 bg-green-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.quadraticCatapult.launch[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                        const gameArea = gameContent.querySelector('.catapult-game'); const canvas = document.getElementById('catapult-canvas'); if (gameArea && canvas) { canvas.width = gameArea.clientWidth; canvas.height = gameArea.clientHeight; }
                        document.getElementById('check-btn').addEventListener('click', () => { const ans = parseInt(document.getElementById('game-answer').value); if (this.currentQuestion.roots.includes(ans)) { document.getElementById('check-btn').disabled = true; this.animateProjectile(ans); } else { showFeedback(false, () => this.init(chapterId)); } });
                    }
                },
                progressionPath: {
                    currentQuestion: null,
                    generateData() { const start = Math.floor(Math.random() * 10) + 1; const diff = Math.floor(Math.random() * 5) + 2; this.currentQuestion = { terms: [start, start + diff, start + diff * 2], answer: start + diff * 3, diff: diff, }; return this.currentQuestion; },
                    getSolutionExplanation() { const { terms, diff, answer } = this.currentQuestion; return { en: `Find the common difference: <b>${terms[1]} - ${terms[0]} = ${diff}</b>. Add it to the last term: <b>${terms[2]} + ${diff} = ${answer}</b>.`, or: `‡¨∏‡¨æ‡¨ß‡¨æ‡¨∞‡¨£ ‡¨Ö‡¨®‡≠ç‡¨§‡¨∞ ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å: <b>${terms[1]} - ${terms[0]} = ${diff}</b>‡•§ ‡¨è‡¨π‡¨æ‡¨ï‡≠Å ‡¨∂‡≠á‡¨∑ ‡¨™‡¨¶‡¨∞‡≠á ‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å: <b>${terms[2]} + ${diff} = ${answer}</b>‡•§`, hi: `‡§∏‡§æ‡§∞‡•ç‡§µ ‡§Ö‡§Ç‡§§‡§∞ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡•Ä‡§ú‡§ø‡§è: <b>${terms[1]} - ${terms[0]} = ${diff}</b>‡•§ ‡§á‡§∏‡•á ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§™‡§¶ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç: <b>${terms[2]} + ${diff} = ${answer}</b>‡•§`, answer: answer }; },
                   init(chapterId) {
                        activeGame = this;
                        const question = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.progressionPath.instruction[currentLanguage]}</p>
                            <div class="flex justify-center items-center gap-4 text-3xl font-bold my-8">
                                <span>üê∏</span>
                                ${question.terms.map(t => `<span class="p-4 bg-green-200 rounded-full">${t}</span>`).join('')}
                                <span class="p-4 bg-gray-300 rounded-full">?</span>
                                <span>üèÅ</span>
                            </div>
                             <div class="flex justify-center items-center gap-4 mt-4">
                                <input id="game-answer" type="number" class="p-2 text-xl text-center w-24 border-2 rounded-lg" />
                                <button id="check-btn" class="px-6 py-3 bg-yellow-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button>
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>
                        `;
                         document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                probabilitySpinner: {
                    currentQuestion: null,
                    gcd(a, b) { return b === 0 ? a : this.gcd(b, a % b); },
                    generateData() { const slices = [ { color: '#3498db', name: 'Blue', count: Math.ceil(Math.random() * 4) }, { color: '#e74c3c', name: 'Red', count: Math.ceil(Math.random() * 4) }, { color: '#2ecc71', name: 'Green', count: Math.ceil(Math.random() * 4) } ]; const total = slices.reduce((sum, s) => sum + s.count, 0); const target = slices[1]; const commonDivisor = this.gcd(target.count, total); this.currentQuestion = { slices, total, targetCount: target.count, answer: { num: target.count / commonDivisor, den: total / commonDivisor } }; return this.currentQuestion; },
                    getSolutionExplanation() { const { total, targetCount, answer } = this.currentQuestion; return { en: `Probability is (Favorable Outcomes) / (Total Outcomes). There are <b>${targetCount}</b> red slices and <b>${total}</b> total slices. The probability is <b>${targetCount}/${total}</b>, which simplifies to <b>${answer.num}/${answer.den}</b>.`, or: `‡¨∏‡¨Æ‡≠ç‡¨≠‡¨æ‡¨¨‡≠ç‡≠ü‡¨§‡¨æ ‡¨π‡≠á‡¨â‡¨õ‡¨ø (‡¨Ö‡¨®‡≠Å‡¨ï‡≠Ç‡¨≥ ‡¨´‡¨≥‡¨æ‡¨´‡¨≥) / (‡¨Æ‡≠ã‡¨ü ‡¨´‡¨≥‡¨æ‡¨´‡¨≥)‡•§ ‡¨è‡¨†‡¨æ‡¨∞‡≠á <b>${targetCount}</b>‡¨ü‡¨ø ‡¨≤‡¨æ‡¨≤‡≠ç ‡¨∏‡≠ç‡¨≤‡¨æ‡¨á‡¨∏‡≠ç ‡¨è‡¨¨‡¨Ç <b>${total}</b>‡¨ü‡¨ø ‡¨Æ‡≠ã‡¨ü ‡¨∏‡≠ç‡¨≤‡¨æ‡¨á‡¨∏‡≠ç ‡¨Ö‡¨õ‡¨ø‡•§ ‡¨∏‡¨Æ‡≠ç‡¨≠‡¨æ‡¨¨‡≠ç‡≠ü‡¨§‡¨æ <b>${targetCount}/${total}</b>, ‡¨Ø‡¨æ‡¨π‡¨æ ‡¨∏‡¨∞‡¨≥‡≠Ä‡¨ï‡≠É‡¨§ ‡¨π‡≠ã‡¨á <b>${answer.num}/${answer.den}</b> ‡¨π‡≠Å‡¨è‡•§`, hi: `‡§™‡•ç‡§∞‡§æ‡§Ø‡§ø‡§ï‡§§‡§æ ‡§π‡•à (‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ) / (‡§ï‡•Å‡§≤ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ)‡•§ ‡§Ø‡§π‡§æ‡§Å <b>${targetCount}</b> ‡§≤‡§æ‡§≤ ‡§∏‡•ç‡§≤‡§æ‡§á‡§∏ ‡§î‡§∞ <b>${total}</b> ‡§ï‡•Å‡§≤ ‡§∏‡•ç‡§≤‡§æ‡§á‡§∏ ‡§π‡•à‡§Ç‡•§ ‡§™‡•ç‡§∞‡§æ‡§Ø‡§ø‡§ï‡§§‡§æ <b>${targetCount}/${total}</b> ‡§π‡•à, ‡§ú‡§ø‡§∏‡•á ‡§∏‡§∞‡§≤ ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ <b>${answer.num}/${answer.den}</b> ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§`, answer: `${answer.num} / ${answer.den}` }; },
                    drawSpinner(data) { let cumulativePercent = 0; const parts = data.slices.map(slice => { const percent = (slice.count / data.total) * 100; const val = `${slice.color} ${cumulativePercent}% ${cumulativePercent + percent}%`; cumulativePercent += percent; return val; }); return `<div class="w-64 h-64 mx-auto my-6 rounded-full" style="background: conic-gradient(${parts.join(', ')});"></div>`; },
                    init(chapterId) {
                        activeGame = this;
                        const question = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.probabilitySpinner.instruction[currentLanguage]}</p>${this.drawSpinner(question)}<div class="flex justify-center items-center gap-4"><span class="text-xl font-bold">${gameData.probabilitySpinner.numerator[currentLanguage]}:</span><input id="num-answer" type="number" class="p-2 text-xl text-center w-20 border-2 rounded-lg" /><span class="text-xl font-bold">${gameData.probabilitySpinner.denominator[currentLanguage]}:</span><input id="den-answer" type="number" class="p-2 text-xl text-center w-20 border-2 rounded-lg" /></div><div class="flex justify-center mt-4"><button id="check-btn" class="px-6 py-3 bg-purple-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                        document.getElementById('check-btn').addEventListener('click', () => { const num = document.getElementById('num-answer').value; const den = document.getElementById('den-answer').value; showFeedback(parseInt(num) === this.currentQuestion.answer.num && parseInt(den) === this.currentQuestion.answer.den, () => this.init(chapterId)); });
                    }
                },
                dataDetective: {
                    currentQuestion: null,
                    generateData() { const data = Array.from({length: 5}, () => Math.floor(Math.random() * 30) + 1); const sorted = [...data].sort((a,b) => a - b); this.currentQuestion = { data, sortedData: sorted, answer: sorted[2] }; return this.currentQuestion; },
                    getSolutionExplanation() { const { data, sortedData, answer } = this.currentQuestion; return { en: `First, sort the numbers: <b>${data.join(', ')}</b> becomes <b>${sortedData.join(', ')}</b>. The median is the middle number.`, or: `‡¨™‡≠ç‡¨∞‡¨•‡¨Æ‡≠á, ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡≠Å ‡¨∏‡¨ú‡¨æ‡¨®‡≠ç‡¨§‡≠Å: <b>${data.join(', ')}</b> ‡¨π‡≠ã‡¨á‡¨Ø‡¨æ‡¨è <b>${sortedData.join(', ')}</b>‡•§ ‡¨Æ‡¨ß‡≠ç‡≠ü‡¨Æ‡¨æ ‡¨π‡≠á‡¨â‡¨õ‡¨ø ‡¨Æ‡¨ù‡¨ø ‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ‡•§`, hi: `‡§™‡§π‡§≤‡•á, ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§ï‡•ç‡§∞‡§Æ‡§¨‡§¶‡•ç‡§ß ‡§ï‡§∞‡•á‡§Ç: <b>${data.join(', ')}</b> ‡§¨‡§® ‡§ú‡§æ‡§§‡§æ ‡§π‡•à <b>${sortedData.join(', ')}</b>‡•§ ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§ø‡§ï‡§æ ‡§¨‡•Ä‡§ö ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§π‡•à‡•§`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const question = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.dataDetective.instruction[currentLanguage]}</p><div class="flex justify-center items-center gap-4 text-3xl font-bold my-8 bg-pink-100 p-4 rounded-lg">${question.data.map(d => `<span>${d}</span>`).join('<span class="text-pink-300">,</span>')}</div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-24 border-2 rounded-lg" placeholder="${gameData.dataDetective.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-pink-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                         document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                distanceDash: {
                    currentQuestion: null,
                    generateData() { const triples = [[3,4,5], [6,8,10], [5,12,13]]; const t = triples[Math.floor(Math.random() * triples.length)]; const p1 = { x: Math.floor(Math.random() * 5), y: Math.floor(Math.random() * 5) }; const p2 = { x: p1.x + t[0], y: p1.y + t[1] }; this.currentQuestion = { p1, p2, answer: t[2] }; return this.currentQuestion; },
                    getSolutionExplanation() { const { p1, p2, answer } = this.currentQuestion; return { en: `Use the distance formula: <b>d = ‚àö((x‚ÇÇ-x‚ÇÅ)¬≤ + (y‚ÇÇ-y‚ÇÅ)¬≤)</b>. This gives d = ‚àö((<b>${p2.x}</b>-<b>${p1.x}</b>)¬≤ + (<b>${p2.y}</b>-<b>${p1.y}</b>)¬≤) = ‚àö<b>${answer**2}</b>.`, or: `‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ ‡¨∏‡≠Ç‡¨§‡≠ç‡¨∞ ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å: <b>d = ‚àö((x‚ÇÇ-x‚ÇÅ)¬≤ + (y‚ÇÇ-y‚ÇÅ)¬≤)</b>‡•§ ‡¨è‡¨π‡¨æ ‡¨¶‡¨ø‡¨è d = ‚àö((<b>${p2.x}</b>-<b>${p1.x}</b>)¬≤ + (<b>${p2.y}</b>-<b>${p1.y}</b>)¬≤) = ‚àö<b>${answer**2}</b>‡•§`, hi: `‡§¶‡•Ç‡§∞‡•Ä ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç: <b>d = ‚àö((x‚ÇÇ-x‚ÇÅ)¬≤ + (y‚ÇÇ-y‚ÇÅ)¬≤)</b>‡•§ ‡§á‡§∏‡§∏‡•á d = ‚àö((<b>${p2.x}</b>-<b>${p1.x}</b>)¬≤ + (<b>${p2.y}</b>-<b>${p1.y}</b>)¬≤) = ‚àö<b>${answer**2}</b> ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à‡•§`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const question = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.distanceDash.instruction[currentLanguage]}</p><div class="text-center text-2xl font-bold my-8 space-y-2"><p>${gameData.distanceDash.pointA[currentLanguage]} <span class="text-indigo-600">(${question.p1.x}, ${question.p1.y})</span></p><p>${gameData.distanceDash.pointB[currentLanguage]} <span class="text-indigo-600">(${question.p2.x}, ${question.p2.y})</span></p></div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-24 border-2 rounded-lg" placeholder="${gameData.distanceDash.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-indigo-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                         document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                safeStopChallenge: {
                    currentQuestion: null,
                    generateData() { const speed = (Math.floor(Math.random() * 5) + 4) * 10; const reactionDist = (speed / 10) * 3; const brakingDist = ((speed / 10) ** 2) / 2; const answer = Math.round(reactionDist + brakingDist); this.currentQuestion = { speed, reactionDist, brakingDist, answer }; return this.currentQuestion; },
                    getSolutionExplanation() { const { reactionDist, brakingDist, answer } = this.currentQuestion; return { en: `Total Stopping Distance = Reaction Distance + Braking Distance. <br>Reaction ‚âà (Speed/10)*3 = <b>${reactionDist.toFixed(1)}m</b>. <br>Braking ‚âà (Speed/10)¬≤/2 = <b>${brakingDist.toFixed(1)}m</b>. <br>Total ‚âà <b>${(reactionDist + brakingDist).toFixed(1)}m</b>.`, or: `‡¨Æ‡≠ã‡¨ü ‡¨Ö‡¨ü‡¨ï‡¨ø‡¨¨‡¨æ ‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ = ‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨ï‡≠ç‡¨∞‡¨ø‡≠ü‡¨æ ‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ + ‡¨¨‡≠ç‡¨∞‡≠á‡¨ï‡¨ø‡¨Ç ‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ‡•§ <br>‡¨™‡≠ç‡¨∞‡¨§‡¨ø‡¨ï‡≠ç‡¨∞‡¨ø‡≠ü‡¨æ ‚âà (‡¨ó‡¨§‡¨ø/10)*3 = <b>${reactionDist.toFixed(1)}m</b>‡•§ <br>‡¨¨‡≠ç‡¨∞‡≠á‡¨ï‡¨ø‡¨Ç ‚âà (‡¨ó‡¨§‡¨ø/10)¬≤/2 = <b>${brakingDist.toFixed(1)}m</b>‡•§ <br>‡¨Æ‡≠ã‡¨ü ‚âà <b>${(reactionDist + brakingDist).toFixed(1)}m</b>‡•§`, hi: `‡§ï‡•Å‡§≤ ‡§∞‡•Å‡§ï‡§®‡•á ‡§ï‡•Ä ‡§¶‡•Ç‡§∞‡•Ä = ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¶‡•Ç‡§∞‡•Ä + ‡§¨‡•ç‡§∞‡•á‡§ï‡§ø‡§Ç‡§ó ‡§¶‡•Ç‡§∞‡•Ä‡•§ <br>‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‚âà (‡§ó‡§§‡§ø/10)*3 = <b>${reactionDist.toFixed(1)}‡§Æ‡•Ä</b>‡•§ <br>‡§¨‡•ç‡§∞‡•á‡§ï‡§ø‡§Ç‡§ó ‚âà (‡§ó‡§§‡§ø/10)¬≤/2 = <b>${brakingDist.toFixed(1)}‡§Æ‡•Ä</b>‡•§ <br>‡§ï‡•Å‡§≤ ‚âà <b>${(reactionDist + brakingDist).toFixed(1)}‡§Æ‡•Ä</b>‡•§`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const question = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.safeStopChallenge.instruction[currentLanguage]}</p><div class="my-8 text-center"><span class="text-5xl font-bold text-red-600">${question.speed}</span> <span class="text-2xl">${gameData.safeStopChallenge.kmh[currentLanguage]}</span></div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-32 border-2 rounded-lg" placeholder="${gameData.safeStopChallenge.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-red-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                         document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                scaleFactorSurveyor: {
                    currentQuestion: null,
                    generateData() { const scale = parseFloat((Math.random() * 1.5 + 1.5).toFixed(1)); const base1 = Math.floor(Math.random() * 5) + 4; const height1 = Math.floor(Math.random() * 5) + 3; const base2 = Math.round(base1 * scale); this.currentQuestion = { base1, height1, base2, answer: Math.round(height1 * scale) }; return this.currentQuestion; },
                    getSolutionExplanation() { const { base1, height1, base2, answer } = this.currentQuestion; return { en: `The ratio of corresponding sides is equal. <br><b>(Height 2 / Height 1) = (Base 2 / Base 1)</b>. <br>So, <b>(X / ${height1}) = (${base2} / ${base1})</b>. <br>This gives <b>X = (${base2} / ${base1}) * ${height1}</b>.`, or: `‡¨Ö‡¨®‡≠Å‡¨∞‡≠Ç‡¨™ ‡¨™‡¨æ‡¨∞‡≠ç‡¨∂‡≠ç‡¨µ‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡¨∞ ‡¨Ö‡¨®‡≠Å‡¨™‡¨æ‡¨§ ‡¨∏‡¨Æ‡¨æ‡¨®‡•§ <br><b>(‡¨â‡¨ö‡≠ç‡¨ö‡¨§‡¨æ 2 / ‡¨â‡¨ö‡≠ç‡¨ö‡¨§‡¨æ 1) = (‡¨≠‡≠Ç‡¨Æ‡¨ø 2 / ‡¨≠‡≠Ç‡¨Æ‡¨ø 1)</b>‡•§ <br>‡¨§‡≠á‡¨£‡≠Å, <b>(X / ${height1}) = (${base2} / ${base1})</b>‡•§ <br>‡¨è‡¨π‡¨æ <b>X = (${base2} / ${base1}) * ${height1}</b> ‡¨¶‡¨ø‡¨è‡•§`, hi: `‡§∏‡§Ç‡§ó‡§§ ‡§≠‡•Å‡§ú‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§™‡§æ‡§§ ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§ <br><b>(‡§ä‡§Å‡§ö‡§æ‡§à 2 / ‡§ä‡§Å‡§ö‡§æ‡§à 1) = (‡§Ü‡§ß‡§æ‡§∞ 2 / ‡§Ü‡§ß‡§æ‡§∞ 1)</b>‡•§ <br>‡§§‡•ã, <b>(X / ${height1}) = (${base2} / ${base1})</b>‡•§ <br>‡§á‡§∏‡§∏‡•á <b>X = (${base2} / ${base1}) * ${height1}</b> ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à‡•§`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const q = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.scaleFactorSurveyor.instruction[currentLanguage]}</p><div class="flex justify-around items-end my-4 h-48"><svg width="120" height="150" viewBox="0 0 120 150"><polygon points="5,145 115,145 5,5" style="fill:none;stroke:orange;stroke-width:3" /><text x="50" y="140" font-size="12" fill="black">${q.base1}</text><text x="15" y="80" font-size="12" transform="rotate(-90 15,80)" fill="black">${q.height1}</text></svg><svg width="180" height="200" viewBox="0 0 180 200"><polygon points="5,195 175,195 5,5" style="fill:none;stroke:orange;stroke-width:3" /><text x="80" y="190" font-size="12" fill="black">${q.base2}</text><text x="15" y="100" font-size="12" transform="rotate(-90 15,100)" fill="black">X</text></svg></div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-32 border-2 rounded-lg" placeholder="${gameData.scaleFactorSurveyor.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-orange-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                         document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                arcAngleArcher: {
                    currentQuestion: null,
                    generateData() { const r = Math.floor(Math.random() * 5) + 5; const theta = [30, 45, 60, 90][Math.floor(Math.random()*4)]; const arcLength = parseFloat(((theta / 360) * 2 * 3.14 * r).toFixed(1)); this.currentQuestion = { r, arcLength, answer: theta }; return this.currentQuestion; },
                    getSolutionExplanation() { const { r, arcLength, answer } = this.currentQuestion; return { en: `Use the formula: <b>Œ∏ = (Arc Length * 360) / (2 * œÄ * r)</b>. <br>Plugging in the values: Œ∏ = (<b>${arcLength}</b> * 360) / (2 * 3.14 * <b>${r}</b>).`, or: `‡¨∏‡≠Ç‡¨§‡≠ç‡¨∞ ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å: <b>Œ∏ = (‡¨ö‡¨æ‡¨™ ‡¨¶‡≠à‡¨∞‡≠ç‡¨ò‡≠ç‡≠ü * 360) / (2 * œÄ * r)</b>‡•§ <br>‡¨Æ‡≠Ç‡¨≤‡≠ç‡≠ü‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡≠Å ‡¨∏‡≠ç‡¨•‡¨æ‡¨™‡¨® ‡¨ï‡¨≤‡≠á: Œ∏ = (<b>${arcLength}</b> * 360) / (2 * 3.14 * <b>${r}</b>)‡•§`, hi: `‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç: <b>Œ∏ = (‡§ö‡§æ‡§™ ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à * 360) / (2 * œÄ * r)</b>‡•§ <br>‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∞‡§ñ‡§®‡•á ‡§™‡§∞: Œ∏ = (<b>${arcLength}</b> * 360) / (2 * 3.14 * <b>${r}</b>)‡•§`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const q = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.arcAngleArcher.instruction[currentLanguage]}</p><div class="flex justify-center items-center my-4"><svg width="200" height="200" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="none" stroke="#ccc" stroke-width="2"/><path d="M 50 50 L 90 50 A 40 40 0 0 1 ${50 + 40*Math.cos(q.answer*Math.PI/180)} ${50 - 40*Math.sin(q.answer*Math.PI/180)} Z" fill="rgba(0,150,255,0.2)" stroke="#0096ff" stroke-width="1"/><text x="65" y="45" font-size="6">r=${q.r}</text><text x="70" y="65" font-size="6">L=${q.arcLength}</text><text x="55" y="55" font-size="6">Œ∏=?</text></svg></div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-32 border-2 rounded-lg" placeholder="${gameData.arcAngleArcher.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-cyan-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                         document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                tangentTracer: {
                    currentQuestion: null,
                    generateData() { const triples = [[3,4,5], [6,8,10], [5,12,13], [8,15,17]]; const t = triples[Math.floor(Math.random() * triples.length)]; this.currentQuestion = { radius: t[0], distance: t[2], answer: t[1] }; return this.currentQuestion; },
                    getSolutionExplanation() { const { radius, distance, answer } = this.currentQuestion; return { en: `The radius and tangent are perpendicular, forming a right triangle with the distance to the center as the hypotenuse. <br>Use Pythagoras: <b>d¬≤ = r¬≤ + t¬≤</b>. <br>So, <b>t¬≤ = d¬≤ - r¬≤ = ${distance**2} - ${radius**2} = ${answer**2}</b>. <br><b>t = ‚àö${answer**2}</b>`, or: `‡¨¨‡≠ç‡≠ü‡¨æ‡¨∏‡¨æ‡¨∞‡≠ç‡¨¶‡≠ç‡¨ß ‡¨è‡¨¨‡¨Ç ‡¨∏‡≠ç‡¨™‡¨∞‡≠ç‡¨∂‡¨ï ‡¨≤‡¨Æ‡≠ç‡¨¨ ‡¨Ö‡¨ü‡¨®‡≠ç‡¨§‡¨ø, ‡¨Ø‡¨æ‡¨π‡¨æ ‡¨ï‡≠á‡¨®‡≠ç‡¨¶‡≠ç‡¨∞‡¨∞‡≠Å ‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ‡¨ï‡≠Å ‡¨ï‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨≠‡¨æ‡¨¨‡¨∞‡≠á ‡¨®‡≠á‡¨á ‡¨è‡¨ï ‡¨∏‡¨Æ‡¨ï‡≠ã‡¨£‡≠Ä ‡¨§‡≠ç‡¨∞‡¨ø‡¨≠‡≠Å‡¨ú ‡¨ó‡¨†‡¨® ‡¨ï‡¨∞‡≠á‡•§ <br>‡¨™‡¨æ‡¨á‡¨•‡¨æ‡¨ó‡≠ã‡¨∞‡¨æ‡¨∏‡≠ç ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å: <b>d¬≤ = r¬≤ + t¬≤</b>‡•§ <br>‡¨§‡≠á‡¨£‡≠Å, <b>t¬≤ = d¬≤ - r¬≤ = ${distance**2} - ${radius**2} = ${answer**2}</b>‡•§ <br><b>t = ‚àö${answer**2}</b>`, hi: `‡§§‡•ç‡§∞‡§ø‡§ú‡•ç‡§Ø‡§æ ‡§î‡§∞ ‡§∏‡•ç‡§™‡§∞‡•ç‡§∂ ‡§∞‡•á‡§ñ‡§æ ‡§≤‡§Ç‡§¨‡§µ‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§∏‡•á ‡§¶‡•Ç‡§∞‡•Ä ‡§ï‡•ã ‡§ï‡§∞‡•ç‡§£ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≤‡•á‡§ï‡§∞ ‡§è‡§ï ‡§∏‡§Æ‡§ï‡•ã‡§£ ‡§§‡•ç‡§∞‡§ø‡§≠‡•Å‡§ú ‡§¨‡§®‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ <br>‡§™‡§æ‡§á‡§•‡§æ‡§ó‡•ã‡§∞‡§∏ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç: <b>d¬≤ = r¬≤ + t¬≤</b>‡•§ <br>‡§§‡•ã, <b>t¬≤ = d¬≤ - r¬≤ = ${distance**2} - ${radius**2} = ${answer**2}</b>‡•§ <br><b>t = ‚àö${answer**2}</b>`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const q = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.tangentTracer.instruction[currentLanguage]}</p><div class="flex justify-center items-center my-4 h-48"><svg width="300" height="150" viewBox="0 0 200 100"><circle cx="50" cy="50" r="40" fill="rgba(190,242,100,0.3)" stroke="#84cc16" stroke-width="2"/><line x1="50" y1="50" x2="180" y2="50" stroke="#666" stroke-width="1"/><line x1="180" y1="50" x2="80" y2="80" stroke="#ef4444" stroke-width="2"/><line x1="50" y1="50" x2="80" y2="80" stroke="#84cc16" stroke-width="1"/><text x="100" y="45" font-size="8">d = ${q.distance}</text><text x="85" y="75" font-size="8" fill="#ef4444">t = ?</text><text x="60" y="60" font-size="8">r = ${q.radius}</text></svg></div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-32 border-2 rounded-lg" placeholder="${gameData.tangentTracer.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-lime-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                        document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                trigTower: {
                    currentQuestion: null,
                    generateData() { const angles = {30: Math.tan(30*Math.PI/180), 45: 1, 60: Math.tan(60*Math.PI/180)}; const angle = [30, 45, 60][Math.floor(Math.random()*3)]; const distance = angle === 45 ? Math.floor(Math.random()*21)+20 : 20; const height = distance * angles[angle]; this.currentQuestion = { angle, distance, answer: Math.round(height) }; return this.currentQuestion; },
                    getSolutionExplanation() { const { angle, distance, answer } = this.currentQuestion; return { en: `Use tangent, as we have the adjacent side (distance) and want to find the opposite side (height). <br><b>tan(Œ∏) = Opposite / Adjacent</b> <br><b>tan(${angle}¬∞) = h / ${distance}</b> <br><b>h = ${distance} * tan(${angle}¬∞)</b>`, or: `‡¨ü‡¨æ‡¨®‡≠ç‡¨ú‡≠á‡¨£‡≠ç‡¨ü‡≠ç ‡¨¨‡≠ç‡≠ü‡¨¨‡¨π‡¨æ‡¨∞ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å, ‡¨ï‡¨æ‡¨∞‡¨£ ‡¨Ü‡¨Æ ‡¨™‡¨æ‡¨ñ‡¨∞‡≠á ‡¨∏‡¨Ç‡¨≤‡¨ó‡≠ç‡¨® ‡¨™‡¨æ‡¨∞‡≠ç‡¨∂‡≠ç‡¨µ (‡¨¶‡≠Ç‡¨∞‡¨§‡¨æ) ‡¨Ö‡¨õ‡¨ø ‡¨è‡¨¨‡¨Ç ‡¨¨‡¨ø‡¨™‡¨∞‡≠Ä‡¨§ ‡¨™‡¨æ‡¨∞‡≠ç‡¨∂‡≠ç‡¨µ (‡¨â‡¨ö‡≠ç‡¨ö‡¨§‡¨æ) ‡¨ñ‡≠ã‡¨ú‡¨ø‡¨¨‡¨æ‡¨ï‡≠Å ‡¨ö‡¨æ‡¨π‡≠Å‡¨Å‡¨õ‡≠Å‡•§ <br><b>tan(Œ∏) = ‡¨¨‡¨ø‡¨™‡¨∞‡≠Ä‡¨§ / ‡¨∏‡¨Ç‡¨≤‡¨ó‡≠ç‡¨®</b> <br><b>tan(${angle}¬∞) = h / ${distance}</b> <br><b>h = ${distance} * tan(${angle}¬∞)</b>`, hi: `‡§∏‡•ç‡§™‡§∞‡•ç‡§∂‡§ú‡•ç‡§Ø‡§æ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§Ü‡§∏‡§®‡•ç‡§® ‡§≠‡•Å‡§ú‡§æ (‡§¶‡•Ç‡§∞‡•Ä) ‡§π‡•à ‡§î‡§∞ ‡§π‡§Æ ‡§∏‡§Æ‡•ç‡§Æ‡•Å‡§ñ ‡§≠‡•Å‡§ú‡§æ (‡§ä‡§Å‡§ö‡§æ‡§à) ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§ <br><b>tan(Œ∏) = ‡§∏‡§Æ‡•ç‡§Æ‡•Å‡§ñ / ‡§Ü‡§∏‡§®‡•ç‡§®</b> <br><b>tan(${angle}¬∞) = h / ${distance}</b> <br><b>h = ${distance} * tan(${angle}¬∞)</b>`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const q = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.trigTower.instruction[currentLanguage]}</p><div class="flex justify-center items-end my-4 h-48"><div class="text-center">üßç</div><div class="w-48 border-b-2 border-black border-dashed"></div><div class="text-center text-4xl">üóº</div></div><div class="text-center font-bold text-xl">d = ${q.distance}m, Œ∏ = ${q.angle}¬∞</div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-32 border-2 rounded-lg" placeholder="${gameData.trigTower.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-fuchsia-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                        document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                volumeVoyage: {
                    currentQuestion: null,
                    generateData() { const r = Math.floor(Math.random() * 4) + 2; const h = Math.floor(Math.random() * 6) + 5; const volume = 3.14 * r * r * h; this.currentQuestion = { r, h, answer: Math.round(volume) }; return this.currentQuestion; },
                    getSolutionExplanation() { const { r, h, answer } = this.currentQuestion; return { en: `The formula for the volume of a cylinder is <b>V = œÄ * r¬≤ * h</b>. <br>Plugging in the values: <br><b>V = 3.14 * ${r}¬≤ * ${h}</b> <br><b>V = 3.14 * ${r*r} * ${h}</b>`, or: `‡¨∏‡¨ø‡¨≤‡¨ø‡¨£‡≠ç‡¨°‡¨∞‡¨∞ ‡¨Ü‡≠ü‡¨§‡¨® ‡¨™‡¨æ‡¨á‡¨Å ‡¨∏‡≠Ç‡¨§‡≠ç‡¨∞ ‡¨π‡≠á‡¨â‡¨õ‡¨ø <b>V = œÄ * r¬≤ * h</b>‡•§ <br>‡¨Æ‡≠Ç‡¨≤‡≠ç‡≠ü‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡≠Å ‡¨∏‡≠ç‡¨•‡¨æ‡¨™‡¨® ‡¨ï‡¨≤‡≠á: <br><b>V = 3.14 * ${r}¬≤ * ${h}</b> <br><b>V = 3.14 * ${r*r} * ${h}</b>`, hi: `‡§è‡§ï ‡§∏‡§ø‡§≤‡•á‡§Ç‡§°‡§∞ ‡§ï‡•á ‡§Ü‡§Ø‡§§‡§® ‡§ï‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§π‡•à <b>V = œÄ * r¬≤ * h</b>‡•§ <br>‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∞‡§ñ‡§®‡•á ‡§™‡§∞: <br><b>V = 3.14 * ${r}¬≤ * ${h}</b> <br><b>V = 3.14 * ${r*r} * ${h}</b>`, answer: answer }; },
                    init(chapterId) {
                        activeGame = this;
                        const q = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-lg mb-4 lang-${currentLanguage}-body">${gameData.volumeVoyage.instruction[currentLanguage]}</p><div class="flex justify-center items-center my-4 h-48"><div style="width:100px; height:150px; background:#fecdd3; border:2px solid #fb7185; border-radius:50px/25px; position:relative;"><div style="position:absolute; top:-12px; left:0; width:100px; height:25px; background:#f9a8d4; border:2px solid #f472b6; border-radius:50px/12.5px;"></div></div><div class="ml-4 text-xl font-bold">r = ${q.r}<br/>h = ${q.h}</div></div><div class="flex justify-center items-center gap-4 mt-4"><input id="game-answer" type="number" class="p-2 text-xl text-center w-32 border-2 rounded-lg" placeholder="${gameData.volumeVoyage.placeholder[currentLanguage]}"/><button id="check-btn" class="px-6 py-3 bg-rose-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.checkAnswer[currentLanguage]}</button></div><div id="feedback-container" class="text-center mt-6"></div>`;
                        document.getElementById('check-btn').addEventListener('click', () => { const ans = document.getElementById('game-answer').value; showFeedback(parseInt(ans) === this.currentQuestion.answer, () => this.init(chapterId)); });
                    }
                },
                constructionCrew: { 
                    currentQuestion: null,
                    steps: [
                        { 
                            svg: '<svg viewBox="0 0 100 100"><path d="M 10 90 L 50 10 L 90 90" stroke="black" stroke-width="2" fill="none"/></svg>',
                            options: [
                                { en: 'Draw an arc from the vertex across both arms.', or: '‡¨∂‡≠Ä‡¨∞‡≠ç‡¨∑‡¨∞‡≠Å ‡¨â‡¨≠‡≠ü ‡¨¨‡¨æ‡¨π‡≠Å ‡¨â‡¨™‡¨∞‡≠á ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§∏‡•á ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡•Å‡§ú‡§æ‡§ì‡§Ç ‡§™‡§∞ ‡§è‡§ï ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§', correct: true},
                                { en: 'Draw a line through the middle.', or: '‡¨Æ‡¨ù‡¨ø‡¨∞‡≠á ‡¨è‡¨ï ‡¨∞‡≠á‡¨ñ‡¨æ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§¨‡•Ä‡§ö ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∞‡•á‡§ñ‡§æ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§', correct: false},
                                { en: 'Measure the angle with a protractor.', or: '‡¨™‡≠ç‡¨∞‡≠ã‡¨ü‡≠ç‡¨∞‡¨æ‡¨ï‡≠ç‡¨ü‡¨∞‡¨∞‡≠á ‡¨ï‡≠ã‡¨£ ‡¨Æ‡¨æ‡¨™‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§ö‡§æ‡§Å‡§¶‡•á ‡§∏‡•á ‡§ï‡•ã‡§£ ‡§Æ‡§æ‡§™‡•á‡§Ç‡•§', correct: false},
                            ],
                            explanation: {
                                en: 'The first step is always to draw an arc from the vertex that intersects both sides (arms) of the angle. This gives you two points to work from.',
                                or: '‡¨™‡≠ç‡¨∞‡¨•‡¨Æ ‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡¨∏‡¨∞‡≠ç‡¨¨‡¨¶‡¨æ ‡¨∂‡≠Ä‡¨∞‡≠ç‡¨∑‡¨∞‡≠Å ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨Ø‡¨æ‡¨π‡¨æ ‡¨ï‡≠ã‡¨£‡¨∞ ‡¨â‡¨≠‡≠ü ‡¨™‡¨æ‡¨∞‡≠ç‡¨∂‡≠ç‡¨µ‡¨ï‡≠Å (‡¨¨‡¨æ‡¨π‡≠Å) ‡¨õ‡≠á‡¨¶ ‡¨ï‡¨∞‡≠á‡•§ ‡¨è‡¨π‡¨æ ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å ‡¨ï‡¨æ‡¨Æ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨¶‡≠Å‡¨á‡¨ü‡¨ø ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å ‡¨¶‡¨ø‡¨è‡•§',
                                hi: '‡§™‡§π‡§≤‡§æ ‡§ï‡§¶‡§Æ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§∏‡•á ‡§è‡§ï ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§ï‡•ã‡§£ ‡§ï‡•á ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§™‡§ï‡•ç‡§∑‡•ã‡§Ç (‡§≠‡•Å‡§ú‡§æ‡§ì‡§Ç) ‡§ï‡•ã ‡§ï‡§æ‡§ü‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§Ü‡§™‡§ï‡•ã ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•ã ‡§¨‡§ø‡§Ç‡§¶‡•Å ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§'
                            },
                            answer: { en: 'Draw an arc from the vertex across both arms.', or: '‡¨∂‡≠Ä‡¨∞‡≠ç‡¨∑‡¨∞‡≠Å ‡¨â‡¨≠‡≠ü ‡¨¨‡¨æ‡¨π‡≠Å ‡¨â‡¨™‡¨∞‡≠á ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§∏‡•á ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡•Å‡§ú‡§æ‡§ì‡§Ç ‡§™‡§∞ ‡§è‡§ï ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§' }
                        },
                        { 
                           svg: '<svg viewBox="0 0 100 100"><path d="M 10 90 L 50 10 L 90 90" stroke="black" stroke-width="2" fill="none"/><path d="M 50 10 a 30 30 0 0 1 25.98 15" stroke="blue" stroke-width="1.5" fill="none" stroke-dasharray="2 2" /><path d="M 50 10 a 30 30 0 0 0 -25.98 15" stroke="blue" stroke-width="1.5" fill="none" stroke-dasharray="2 2" /></svg>',
                            options: [
                                { en: 'From an intersection point, draw an arc inside the angle.', or: '‡¨è‡¨ï ‡¨õ‡≠á‡¨¶ ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å‡¨∞‡≠Å, ‡¨ï‡≠ã‡¨£ ‡¨≠‡¨ø‡¨§‡¨∞‡≠á ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§è‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§ö‡•ç‡§õ‡•á‡§¶‡§® ‡§¨‡§ø‡§Ç‡§¶‡•Å ‡§∏‡•á, ‡§ï‡•ã‡§£ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§è‡§ï ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§', correct: true},
                                { en: 'Draw the same arc again.', or: '‡¨∏‡≠á‡¨π‡¨ø ‡¨ö‡¨æ‡¨™‡¨ï‡≠Å ‡¨™‡≠Å‡¨£‡¨ø‡¨•‡¨∞‡≠á ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§µ‡§π‡•Ä ‡§ö‡§æ‡§™ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§', correct: false},
                                { en: 'Connect the intersection points.', or: '‡¨õ‡≠á‡¨¶ ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å‡¨ó‡≠Å‡¨°‡¨º‡¨ø‡¨ï‡≠Å ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§™‡•ç‡§∞‡§§‡§ø‡§ö‡•ç‡§õ‡•á‡§¶‡§® ‡§¨‡§ø‡§Ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§', correct: false},
                            ],
                            explanation: {
                                en: 'Place the compass on one of the points where the first arc intersected an arm, and draw another arc in the center of the angle.',
                                or: '‡¨™‡≠ç‡¨∞‡¨•‡¨Æ ‡¨ö‡¨æ‡¨™ ‡¨¨‡¨æ‡¨π‡≠Å‡¨ï‡≠Å ‡¨õ‡≠á‡¨¶ ‡¨ï‡¨∞‡¨ø‡¨•‡¨ø‡¨¨‡¨æ ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å‡¨Æ‡¨æ‡¨®‡¨ô‡≠ç‡¨ï ‡¨Æ‡¨ß‡≠ç‡≠ü‡¨∞‡≠Å ‡¨ó‡≠ã‡¨ü‡¨ø‡¨ï ‡¨â‡¨™‡¨∞‡≠á ‡¨ï‡¨Æ‡≠ç‡¨™‡¨æ‡¨∏‡≠ç ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å, ‡¨è‡¨¨‡¨Ç ‡¨ï‡≠ã‡¨£‡¨∞ ‡¨ï‡≠á‡¨®‡≠ç‡¨¶‡≠ç‡¨∞‡¨∞‡≠á ‡¨Ü‡¨â ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                                hi: '‡§ï‡§Æ‡•ç‡§™‡§æ‡§∏ ‡§ï‡•ã ‡§â‡§® ‡§¨‡§ø‡§Ç‡§¶‡•Å‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§è‡§ï ‡§™‡§∞ ‡§∞‡§ñ‡•á‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§™‡§π‡§≤‡§æ ‡§ö‡§æ‡§™ ‡§è‡§ï ‡§≠‡•Å‡§ú‡§æ ‡§ï‡•ã ‡§ï‡§æ‡§ü‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§ï‡•ã‡§£ ‡§ï‡•á ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§î‡§∞ ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§'
                            },
                            answer: { en: 'From an intersection point, draw an arc inside the angle.', or: '‡¨è‡¨ï ‡¨õ‡≠á‡¨¶ ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å‡¨∞‡≠Å, ‡¨ï‡≠ã‡¨£ ‡¨≠‡¨ø‡¨§‡¨∞‡≠á ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§è‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§ö‡•ç‡§õ‡•á‡§¶‡§® ‡§¨‡§ø‡§Ç‡§¶‡•Å ‡§∏‡•á, ‡§ï‡•ã‡§£ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§è‡§ï ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§' }
                        },
                         { 
                           svg: '<svg viewBox="0 0 100 100"><path d="M 10 90 L 50 10 L 90 90" stroke="black" stroke-width="2" fill="none"/><path d="M 50 10 a 30 30 0 0 1 25.98 15" stroke="blue" stroke-width="1.5" fill="none" stroke-dasharray="2 2" /><path d="M 50 10 a 30 30 0 0 0 -25.98 15" stroke="blue" stroke-width="1.5" fill="none" stroke-dasharray="2 2" /><path d="M 24.02 25 a 30 30 0 0 1 30 0" stroke="red" stroke-width="1.5" fill="none" /></svg>',
                            options: [
                                { en: 'From the other intersection, draw an arc to cross the red one.', or: '‡¨Ö‡¨®‡≠ç‡≠ü ‡¨õ‡≠á‡¨¶‡¨∞‡≠Å, ‡¨≤‡¨æ‡¨≤‡≠ç ‡¨ö‡¨æ‡¨™‡¨ï‡≠Å ‡¨õ‡≠á‡¨¶ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§¶‡•Ç‡§∏‡§∞‡•á ‡§™‡•ç‡§∞‡§§‡§ø‡§ö‡•ç‡§õ‡•á‡§¶‡§® ‡§∏‡•á, ‡§≤‡§æ‡§≤ ‡§µ‡§æ‡§≤‡•á ‡§ï‡•ã ‡§™‡§æ‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§', correct: true},
                                { en: 'Draw a line from the vertex to the red arc.', or: '‡¨∂‡≠Ä‡¨∞‡≠ç‡¨∑‡¨∞‡≠Å ‡¨≤‡¨æ‡¨≤‡≠ç ‡¨ö‡¨æ‡¨™ ‡¨™‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü‡¨®‡≠ç‡¨§ ‡¨è‡¨ï ‡¨∞‡≠á‡¨ñ‡¨æ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§∏‡•á ‡§≤‡§æ‡§≤ ‡§ö‡§æ‡§™ ‡§§‡§ï ‡§è‡§ï ‡§∞‡•á‡§ñ‡§æ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§', correct: false},
                                { en: 'Erase the blue arc.', or: '‡¨®‡≠Ä‡¨≥ ‡¨ö‡¨æ‡¨™‡¨ï‡≠Å ‡¨≤‡¨ø‡¨≠‡¨æ‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§®‡•Ä‡§≤‡•á ‡§ö‡§æ‡§™ ‡§ï‡•ã ‡§Æ‡§ø‡§ü‡§æ ‡§¶‡•á‡§Ç‡•§', correct: false},
                            ],
                             explanation: {
                                en: "Without changing the compass width, move to the other intersection point (on the other arm) and draw a second arc that crosses the first one you just drew.",
                                or: '‡¨ï‡¨Æ‡≠ç‡¨™‡¨æ‡¨∏‡¨∞ ‡¨™‡≠ç‡¨∞‡¨∏‡≠ç‡¨• ‡¨™‡¨∞‡¨ø‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡¨® ‡¨®‡¨ï‡¨∞‡¨ø, ‡¨Ö‡¨®‡≠ç‡≠ü ‡¨õ‡≠á‡¨¶ ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å‡¨ï‡≠Å (‡¨Ö‡¨®‡≠ç‡≠ü ‡¨¨‡¨æ‡¨π‡≠Å ‡¨â‡¨™‡¨∞‡≠á) ‡¨Ø‡¨æ‡¨Ü‡¨®‡≠ç‡¨§‡≠Å ‡¨è‡¨¨‡¨Ç ‡¨Ü‡¨™‡¨£ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨ø‡¨•‡¨ø‡¨¨‡¨æ ‡¨™‡≠ç‡¨∞‡¨•‡¨Æ ‡¨ö‡¨æ‡¨™‡¨ï‡≠Å ‡¨õ‡≠á‡¨¶ ‡¨ï‡¨∞‡≠Å‡¨•‡¨ø‡¨¨‡¨æ ‡¨¶‡≠ç‡≠±‡¨ø‡¨§‡≠Ä‡≠ü ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                                hi: '‡§ï‡§Æ‡•ç‡§™‡§æ‡§∏ ‡§ï‡•Ä ‡§ö‡•å‡§°‡§º‡§æ‡§à ‡§ï‡•ã ‡§¨‡§¶‡§≤‡•á ‡§¨‡§ø‡§®‡§æ, ‡§¶‡•Ç‡§∏‡§∞‡•á ‡§™‡•ç‡§∞‡§§‡§ø‡§ö‡•ç‡§õ‡•á‡§¶‡§® ‡§¨‡§ø‡§Ç‡§¶‡•Å (‡§¶‡•Ç‡§∏‡§∞‡•Ä ‡§≠‡•Å‡§ú‡§æ ‡§™‡§∞) ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§è‡§ï ‡§¶‡•Ç‡§∏‡§∞‡§æ ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç ‡§ú‡•ã ‡§Ü‡§™‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ö‡§≠‡•Ä ‡§ñ‡•Ä‡§Ç‡§ö‡•á ‡§ó‡§è ‡§™‡§π‡§≤‡•á ‡§ö‡§æ‡§™ ‡§ï‡•ã ‡§ï‡§æ‡§ü‡§§‡§æ ‡§π‡•à‡•§'
                            },
                            answer: { en: 'From the other intersection, draw an arc to cross the red one.', or: '‡¨Ö‡¨®‡≠ç‡≠ü ‡¨õ‡≠á‡¨¶‡¨∞‡≠Å, ‡¨≤‡¨æ‡¨≤‡≠ç ‡¨ö‡¨æ‡¨™‡¨ï‡≠Å ‡¨õ‡≠á‡¨¶ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨è‡¨ï ‡¨ö‡¨æ‡¨™ ‡¨Ö‡¨ô‡≠ç‡¨ï‡¨® ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§', hi: '‡§¶‡•Ç‡§∏‡§∞‡•á ‡§™‡•ç‡§∞‡§§‡§ø‡§ö‡•ç‡§õ‡•á‡§¶‡§® ‡§∏‡•á, ‡§≤‡§æ‡§≤ ‡§µ‡§æ‡§≤‡•á ‡§ï‡•ã ‡§™‡§æ‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ö‡§æ‡§™ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§' }
                        }
                    ],
                    shuffle(array) { let c = array.length, r, t; while (c !== 0) { r = Math.floor(Math.random() * c); c--; t = array[c]; array[c] = array[r]; array[r] = t; } return array; },
                    generateData() { this.currentQuestion = this.steps[Math.floor(Math.random() * this.steps.length)]; return this.currentQuestion; },
                    getSolutionExplanation() { const { explanation, answer } = this.currentQuestion; return { en: explanation.en, or: explanation.or, hi: explanation.hi, answer: answer[currentLanguage] }; },
                    init(chapterId) {
                        activeGame = this;
                        const q = this.generateData();
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        const shuffledOptions = this.shuffle([...q.options]);
                        gameContent.innerHTML = `
                            <p class="text-center text-lg mb-2 lang-${currentLanguage}-body">${gameData.constructionCrew.instruction[currentLanguage]}</p>
                            <div class="flex justify-center items-center my-2 h-48 border rounded-lg bg-sky-50">${q.svg}</div>
                            <div class="grid grid-cols-1 gap-3 mt-4">
                                ${shuffledOptions.map(opt => `<button class="game-option-btn p-3 text-left rounded-lg lang-${currentLanguage}-body" data-correct="${opt.correct}">${opt[currentLanguage]}</button>`).join('')}
                            </div>
                            <div id="feedback-container" class="text-center mt-6"></div>`;
                        gameContent.querySelectorAll('.game-option-btn').forEach(btn => btn.addEventListener('click', e => { showFeedback(e.currentTarget.dataset.correct === 'true', () => this.init(chapterId)); }));
                    }
                },
                comingSoon: {
                    init(chapterId) {
                        const gameInfo = textContent.chapters.find(c => c.id === chapterId);
                        gameTitle.textContent = gameInfo.title[currentLanguage];
                        gameContent.innerHTML = `<p class="text-center text-2xl p-8 lang-${currentLanguage}-body">${currentLanguage === 'en' ? 'This game is under construction. Check back later!' : (currentLanguage === 'or' ? '‡¨è‡¨π‡¨ø ‡¨ñ‡≠á‡¨≥ ‡¨®‡¨ø‡¨∞‡≠ç‡¨Æ‡¨æ‡¨£‡¨æ‡¨ß‡≠Ä‡¨® ‡¨Ö‡¨õ‡¨ø | ‡¨™‡¨∞‡≠á ‡¨™‡≠Å‡¨£‡¨ø ‡¨¶‡≠á‡¨ñ‡¨®‡≠ç‡¨§‡≠Å!' : '‡§Ø‡§π ‡§ó‡•á‡§Æ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£‡§æ‡§ß‡•Ä‡§® ‡§π‡•à‡•§ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§´‡§ø‡§∞ ‡§¶‡•á‡§ñ‡•á‡§Ç!')}</p>`;
                    }
                }
            };
            
            function showFeedback(isCorrect, nextCallback, message) {
                const feedbackContainer = document.getElementById('feedback-container');
                if (!feedbackContainer) return;

                gameContent.querySelectorAll('button, input').forEach(el => el.disabled = true);
                
                if (isCorrect) {
                    feedbackContainer.innerHTML = `<p class="text-2xl font-bold text-green-600">${message || gameData.correct[currentLanguage]}</p>`;
                    setTimeout(() => { 
                        if (gameModal.classList.contains('hidden')) return;
                        if(nextCallback) nextCallback(); 
                        if(feedbackContainer) feedbackContainer.innerHTML = '';
                    }, 1500);
                } else {
                    const solution = activeGame.getSolutionExplanation();
                    feedbackContainer.innerHTML = `
                        <p class="text-2xl font-bold text-red-600 mb-4">${gameData.tryAgain[currentLanguage]}</p>
                        <div class="solution-box text-left">
                            <h3 class="font-bold text-lg mb-2">${gameData.solutionTitle[currentLanguage]}</h3>
                            <p class="text-gray-700 lang-${currentLanguage}-body">${solution[currentLanguage]}</p>
                            <p class="mt-3"><b>${gameData.correctAnswerIs[currentLanguage]}: <span class="text-blue-600">${solution.answer}</span></b></p>
                            <button id="next-q-btn" class="mt-4 w-full px-6 py-3 bg-blue-500 text-white font-bold rounded-lg lang-${currentLanguage}">${gameData.nextQuestion[currentLanguage]}</button>
                        </div>`;

                    document.getElementById('next-q-btn').addEventListener('click', () => {
                        if (nextCallback) nextCallback();
                    });
                }
            }
            
            function updateLanguage() {
                document.querySelectorAll('[id^="platform-title"], .chapter-title, .lang-en, .lang-or, .lang-hi, .lang-or-body, .lang-hi-body').forEach(el => {
                    el.classList.remove('lang-en', 'lang-or', 'lang-hi', 'lang-or-body', 'lang-hi-body');
                    if (el.classList.contains('chapter-title') || el.tagName === 'H1' || el.tagName === 'H2' || el.classList.contains('play-now-btn')) {
                         el.classList.add(`lang-${currentLanguage}`);
                    } else {
                         el.classList.add(`lang-${currentLanguage}-body`);
                    }
                });
                
                document.getElementById('platform-title').textContent = textContent.platformTitle[currentLanguage];
                document.querySelector('#start-screen h1').textContent = {en: '10th Grade Math', or: '‡¨¶‡¨∂‡¨Æ ‡¨∂‡≠ç‡¨∞‡≠á‡¨£‡≠Ä ‡¨ó‡¨£‡¨ø‡¨§', hi: '‡§ï‡§ï‡•ç‡§∑‡§æ 10 ‡§ó‡§£‡§ø‡§§'}[currentLanguage];
                document.querySelector('#start-screen p').textContent = {en: 'The Next Level of Adventure!', or: '‡¨∏‡¨æ‡¨π‡¨∏‡¨ø‡¨ï‡¨§‡¨æ‡¨∞ ‡¨™‡¨∞‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡≠Ä ‡¨∏‡≠ç‡¨§‡¨∞!', hi: '‡§∏‡§æ‡§π‡§∏‡§ø‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§æ ‡§Ö‡§ó‡§≤‡§æ ‡§∏‡•ç‡§§‡§∞!'}[currentLanguage];
                document.getElementById('play-now-btn').textContent = {en: 'Play Now', or: '‡¨è‡¨¨‡≠á ‡¨ñ‡≠á‡¨≥‡¨®‡≠ç‡¨§‡≠Å', hi: '‡§Ö‡§¨ ‡§ñ‡•á‡§≤‡•á‡§Ç'}[currentLanguage];
                
                renderChapters();
                updateActiveLangButtons();

                // If a game modal is open, re-initialize it to update the language
                if (activeGame && !gameModal.classList.contains('hidden')) {
                    const chapterId = gameTitle.dataset.chapterId;
                    if (chapterId) {
                        const gameId = textContent.chapters.find(c => c.id === chapterId)?.units[0]?.game;
                        const game = games[gameId] || games.comingSoon;
                        game.init(chapterId);
                    }
                }
            }
            
            function updateActiveLangButtons() {
                const allButtons = document.querySelectorAll('[id$="-lang-en-btn"], [id$="-lang-or-btn"], [id$="-lang-hi-btn"]');
                allButtons.forEach(btn => {
                    btn.classList.remove('bg-yellow-400', 'text-white', 'font-extrabold');
                    btn.classList.add('text-gray-600');
                });

                const activeButtons = document.querySelectorAll(`[id$="-lang-${currentLanguage}-btn"]`);
                activeButtons.forEach(btn => {
                    btn.classList.add('bg-yellow-400', 'text-white', 'font-extrabold');
                });
            }

            function setLanguage(lang) {
                currentLanguage = lang;
                updateLanguage();
            }

            // --- Event Listeners ---
            document.querySelectorAll('[id$="-lang-en-btn"]').forEach(btn => btn.addEventListener('click', () => setLanguage('en')));
            document.querySelectorAll('[id$="-lang-or-btn"]').forEach(btn => btn.addEventListener('click', () => setLanguage('or')));
            document.querySelectorAll('[id$="-lang-hi-btn"]').forEach(btn => btn.addEventListener('click', () => setLanguage('hi')));

            document.getElementById('play-now-btn').addEventListener('click', () => {
                const startScreen = document.getElementById('start-screen');
                const appContainer = document.getElementById('app-container');
                startScreen.style.opacity = '0';
                setTimeout(() => {
                    startScreen.classList.add('hidden');
                    appContainer.classList.remove('hidden');
                    appContainer.style.opacity = '1';
                }, 500);
            });

            mainContent.addEventListener('click', (e) => {
                const chapterCard = e.target.closest('.chapter-card');
                if (chapterCard) {
                    const gameId = chapterCard.dataset.game;
                    const chapterId = chapterCard.dataset.chapterId;
                    // Store chapterId on the modal title to retrieve it if the language changes
                    gameTitle.dataset.chapterId = chapterId;
                    const game = games[gameId] || games.comingSoon;
                    game.init(chapterId); // Pass chapterId for 'comingSoon'
                    gameModal.classList.remove('hidden');
                }
            });

            document.getElementById('close-modal-btn').addEventListener('click', () => {
                gameModal.classList.add('hidden');
                gameContent.innerHTML = '';
                activeGame = null;
            });
            
            // --- Initial Load ---
            createBackground();
            updateLanguage();
        });
    </script>
</body>
</html>

